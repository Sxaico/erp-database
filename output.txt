.gitignore

# dependencias / caches
__pycache__/
*.pyc
node_modules/
*.log

# entornos / secretos locales
api/.env
.env

# datos locales de postgres
pgdata/

# artefactos de editor/OS
.DS_Store
.vscode/
.idea/


---
docker-compose.yml

services:
  # 1. Base de Datos
  postgres:
    image: postgres:16
    container_name: erp_postgres
    environment:
      POSTGRES_DB: erp_db
      POSTGRES_USER: erp_user
      POSTGRES_PASSWORD: erp_password123
      TZ: America/Argentina/Buenos_Aires
    ports:
      - "5432:5432"
    volumes:
      - ./pgdata:/var/lib/postgresql/data
      - ./init-scripts:/docker-entrypoint-initdb.d
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U erp_user -d erp_db"]
      interval: 10s
      timeout: 5s
      retries: 10
    restart: unless-stopped

  # 2. Administrador de DB (pgAdmin)
  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: erp_pgadmin
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@miempresa.com
      PGADMIN_DEFAULT_PASSWORD: admin123
      TZ: America/Argentina/Buenos_Aires
    ports:
      - "8080:80"
    depends_on:
      postgres:
        condition: service_healthy
    volumes:
      - ./pgadmin-data:/var/lib/pgadmin
    restart: unless-stopped

  # 3. API Backend (FastAPI)
  api:
    build:
      context: ./api
      dockerfile: Dockerfile
    container_name: erp_api
    env_file:
      - ./api/.env
    ports:
      - "8000:8000"
    depends_on:
      postgres:
        condition: service_healthy
    volumes:
      - ./api:/app
    restart: unless-stopped

  # 4. Frontend Low-Code (Appsmith) - NUEVO
  appsmith:
    image: index.docker.io/appsmith/appsmith-ce
    container_name: erp_appsmith
    ports:
      - "80:80"     # Acceso web principal
      - "9001:9001" # Supervisor (opcional)
    volumes:
      - ./appsmith-stacks:/appsmith-stacks
    restart: unless-stopped
    # Appsmith usa la red default bridge para ver a 'postgres' por su nombre

---
Plan.md

# PLAN ‚Äî Hitos y pr√≥ximos pasos

## Hitos completados (MVP)
1. **Infra local** con Docker Compose: Postgres 16 + pgAdmin + API + Web.
2. **DB**: tablas de usuarios/roles/organizaciones/departamentos/proyectos/tareas + vista agregada + `proyecto_miembros`.
3. **Auth**: login JWT, `/auth/refresh`, guards por roles/permisos.
4. **Projects/Tasks**: endpoints CRUD m√≠nimos + membres√≠as + reporte por estado.
5. **UI m√≠nima**: Login + rutas protegidas + llamadas a health; correcci√≥n import `ProtectedRoute`.
6. **Seeds √∫tiles**: admin + colaboradores de prueba.

## Gap review r√°pido
- UI a√∫n b√°sica (falta listado/tabla/edici√≥n ‚Äúlinda‚Äù).
- Migraciones no gestionadas con Alembic (solo scripts init).
- Falta hardening para prod (SECRET_KEY/HTTPS/backup/monitoring).

## Pr√≥ximos pasos a **pre-producci√≥n**
1. **Alembic** para migraciones (crear carpeta `alembic/`, `env.py`, `script.py.mako`).
2. **UI m√≠nima operable**:
   - Listado de proyectos y tareas con filtros.
   - Crear/editar desde UI + **refresco instant√°neo** de listas (React Query).
   - Cambio libre de estado de tareas (no solo ‚ÄúHECHA‚Äù).
3. **Dashboard MVP**:
   - Tarjetas: proyectos activos, tareas por estado, √∫ltimas anotaciones.
   - Gr√°fico simple (Recharts) por progreso/estado.
4. **Seguridad y prod**:
   - SECRET_KEY/creds fuertes, `DEBUG=false`, CORS dominio.
   - Nginx + Certbot; backups cron de Postgres.
5. **Observabilidad**:
   - Access/error logs centralizados.
   - Healthcheck + endpoint `/metrics` (opcional con Prometheus FastAPI).

## Roadmap a **producci√≥n**
- **UI full** (role-based): p√°ginas de admin, permisos granulares.
- **Dashboard ejecutivo** con KPIs (tiempos, costos, avance vs plan).
- **Anotaciones/mediciones** (modelo y UI) + agregados por proyecto/√°rea/tiempo.
- **Notificaciones** (email/webhooks).
- **Auditor√≠a** (tabla de eventos, qui√©n cambi√≥ qu√©/cu√°ndo).
- **CI/CD** (GitHub Actions: build + test + push images + deploy).

---
README.md


# ERP MVP ‚Äî FastAPI + PostgreSQL + React (Vite)

MVP funcional para **gesti√≥n b√°sica de proyectos y tareas** con **autenticaci√≥n por roles** (JWT).  
Stack: **FastAPI**, **PostgreSQL**, **pgAdmin**, **Vite/React** en **Docker Compose**.

---

## üöÄ Quick Start (local)

```bash
# 1) Clonar
git clone <TU_REPO.git> erp-mvp
cd erp-mvp

# 2) Levantar stack
docker compose up -d --build

# 3) Verificar
# API health:
http://localhost:8000/health
# Docs:
http://localhost:8000/docs
# UI:
http://localhost:5173/
# pgAdmin:
http://localhost:8080/
```

> Si cambias puertos, aj√∫stalos en `docker-compose.yml`.

---

## üß± Servicios (local)

| Servicio  | URL                            | Notas                      |
| --------- | ------------------------------ | -------------------------- |
| API       | `http://localhost:8000`        | Docs en `/docs` y `/redoc` |
| Health    | `http://localhost:8000/health` | Estado DB y versi√≥n        |
| UI (Vite) | `http://localhost:5173`        | UI m√≠nima                  |
| pgAdmin   | `http://localhost:8080`        | Admin DB                   |

**pgAdmin (primera vez)**
Usuario: `admin@miempresa.com` ‚Äî Password: `admin123`
Conectar servidor:

* Host: `postgres` ‚Äî Port: `5432`
* DB: `erp_db` ‚Äî User: `erp_user` ‚Äî Pass: `erp_password123`

---

## üîë Cuentas de prueba (seeds)

| Email                  | Password   | Rol         |
| ---------------------- | ---------- | ----------- |
| `admin@miempresa.com`  | `admin123` | Super Admin |
| `colab1@miempresa.com` | `user123`  | Colaborador |
| `colab2@miempresa.com` | `user123`  | Colaborador |
| `colab3@miempresa.com` | `user123`  | Colaborador |

> Los seeds se cargan con `init-scripts/*` en el primer arranque.
> Si ya existe `./pgdata/`, Postgres **no** los re-ejecuta (ver ‚ÄúReset DB‚Äù abajo).

---

## üì¶ Estructura (resumen)

```bash
.
‚îú‚îÄ api/
‚îÇ  ‚îú‚îÄ .env
‚îÇ  ‚îú‚îÄ Dockerfile
‚îÇ  ‚îú‚îÄ requirements.txt
‚îÇ  ‚îî‚îÄ app/
‚îÇ     ‚îú‚îÄ main.py, config.py, database.py
‚îÇ     ‚îú‚îÄ utils/ (security, dependencies)
‚îÇ     ‚îú‚îÄ auth/ (models, schemas, routes)
‚îÇ     ‚îî‚îÄ projects/ (models, schemas, routes)
‚îú‚îÄ init-scripts/ (DDL + seeds)
‚îú‚îÄ docker-compose.yml
‚îî‚îÄ web/  (Vite + React)
   ‚îú‚îÄ package.json
   ‚îú‚îÄ src/
   ‚îÇ  ‚îú‚îÄ main.tsx
   ‚îÇ  ‚îú‚îÄ App.tsx
   ‚îÇ  ‚îú‚îÄ components/ProtectedRoute.tsx
   ‚îÇ  ‚îî‚îÄ styles.css   ‚Üê (tiny CSS opcional)
```

---

## üîê Endpoints (API)

**Auth**

* `POST /api/auth/login` ‚Üí `{ access_token, refresh_token, expires_in, user }`
* `POST /api/auth/refresh` ‚Üí `{ access_token, expires_in }`
* `GET /api/auth/me` (Bearer) ‚Üí usuario actual
* `GET /api/auth/users` (Admin/Super Admin)

**Projects & Tasks**

* `POST /api/projects` (write\:projects) ‚Üí crear proyecto
* `GET /api/projects` (read\:projects) ‚Üí listar visibles seg√∫n rol/membres√≠a
* `GET /api/projects/{id}` (read\:projects) ‚Üí detalle si hay acceso
* `PATCH /api/projects/{id}` (write\:projects) ‚Üí actualizar
* `POST /api/projects/tasks` (write\:tasks) ‚Üí crear tarea
* `GET /api/projects/{id}/tasks` (read\:tasks) ‚Üí listar tareas
* `PATCH /api/projects/tasks/{task_id}` (write\:tasks) ‚Üí actualizar tarea
* `GET /api/projects/{id}/report/estado` (read\:reports) ‚Üí vista agregada por estado

**Miembros de proyecto**

* `GET /api/projects/{id}/members` (read\:projects)
* `POST /api/projects/{id}/members` (write\:projects + Admin)
  body: `{ usuario_id?: number, email?: string }`
* `DELETE /api/projects/{id}/members/{usuario_id}` (write\:projects + Admin)

---

## ‚öôÔ∏è Variables de entorno (api/.env)


```env
APP_NAME="ERP API"
VERSION="1.0.0"
DESCRIPTION="Sistema de Gesti√≥n Empresarial - API Backend"
DATABASE_URL="postgresql+asyncpg://erp_user:erp_password123@postgres:5432/erp_db"
DATABASE_URL_SYNC="postgresql://erp_user:erp_password123@postgres:5432/erp_db"
HOST="0.0.0.0"
PORT=8000
DEBUG=true
SECRET_KEY="C√ÅMBIAME_EN_PROD"
ALGORITHM="HS256"
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALLOWED_ORIGINS="http://localhost:5173,http://127.0.0.1:5173"
MAX_UPLOAD_SIZE=10485760
ITEMS_PER_PAGE=50
```

> En **producci√≥n**, cambia `SECRET_KEY`, contrase√±as y `ALLOWED_ORIGINS` (tu dominio).

---

## üß™ Pruebas r√°pidas (PowerShell)

```powershell
# Login admin
$resp = Invoke-RestMethod -Method POST -Uri "http://localhost:8000/api/auth/login" `
  -ContentType "application/json" `
  -Body '{"email":"admin@miempresa.com","password":"admin123"}'
$AT = $resp.access_token

# Me
Invoke-RestMethod -Method GET -Uri "http://localhost:8000/api/auth/me" `
  -Headers @{ Authorization = "Bearer $AT" } | ConvertTo-Json -Depth 6

# Crear proyecto
$createProjBody = @{ codigo="MVP-0001"; nombre="MVP Demo"; descripcion="Proyecto MVP e2e"; prioridad=2 } | ConvertTo-Json
$proj = Invoke-RestMethod -Method POST -Uri "http://localhost:8000/api/projects" `
  -Headers @{ Authorization = "Bearer $AT" } -ContentType "application/json" -Body $createProjBody
$PROJ_ID = $proj.id

# Crear tareas
$body1 = @{ proyecto_id=$PROJ_ID; titulo="Tarea 1"; descripcion="..."; prioridad=2 } | ConvertTo-Json
$body2 = @{ proyecto_id=$PROJ_ID; titulo="Tarea 2"; descripcion="..."; prioridad=2 } | ConvertTo-Json
$t1 = Invoke-RestMethod -Method POST -Uri "http://localhost:8000/api/projects/tasks" `
  -Headers @{ Authorization = "Bearer $AT" } -ContentType "application/json" -Body $body1
$t2 = Invoke-RestMethod -Method POST -Uri "http://localhost:8000/api/projects/tasks" `
  -Headers @{ Authorization = "Bearer $AT" } -ContentType "application/json" -Body $body2

# Cambiar estado
Invoke-RestMethod -Method PATCH -Uri "http://localhost:8000/api/projects/tasks/$($t1.id)" `
  -Headers @{ Authorization = "Bearer $AT" } -ContentType "application/json" `
  -Body (@{ estado="HECHA" } | ConvertTo-Json)

# Reporte por estado
Invoke-RestMethod -Method GET -Uri "http://localhost:8000/api/projects/$PROJ_ID/report/estado" `
  -Headers @{ Authorization = "Bearer $AT" } | ConvertTo-Json -Depth 6
```

---

## üñ•Ô∏è UI m√≠nima & tiny CSS

* En `web/src/main.tsx` ya est√° corregida la importaci√≥n:
  `import ProtectedRoute from "./components/ProtectedRoute";`
* Puedes a√±adir estilos r√°pidos con `web/src/styles.css` (ver abajo ‚Äútiny CSS‚Äù).
* web/ sirve con Vite en http://localhost:5173/.

---

## üß∞ Troubleshooting

* **Puertos ocupados**: libera 5432/8000/8080/5173 o ajusta puertos.
* **Seeds no corren**: si existe `./pgdata/`, no se re-ejecutan.
* **Reset DB** (‚ö†Ô∏è borra datos locales):

 ```bash
 docker compose down
 rm -rf ./pgdata
 docker compose up -d --build
 ```

* **Logs**:

 ```bash
 docker compose logs -f api
 docker compose logs -f web
 docker compose logs -f postgres
 ```

---

## üö¢ Despliegue recomendado (Debian 12)

**Opci√≥n ganadora (simple y robusta)**: *Docker Compose + Nginx reverse proxy + Certbot (TLS)*

1. **Servidor** (Debian 12, usuario no-root con sudo).
2. **Instalar Docker & Compose**:

 ```bash
 sudo apt update
 sudo apt install -y ca-certificates curl gnupg
 sudo install -m 0755 -d /etc/apt/keyrings
 curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
 echo \
 "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
 https://download.docker.com/linux/debian $(. /etc/os-release && echo $VERSION_CODENAME) stable" \
 | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
 sudo apt update
 sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin
 sudo usermod -aG docker $USER
 newgrp docker
 ```
  
3. **Clonar repo** y crear `.env` de producci√≥n (API) con secretos reales y `ALLOWED_ORIGINS="https://tu-dominio.com"`.
4. **Ajustar `docker-compose.yml`**: cambia puertos si usas Nginx (ver m√°s abajo).
5. **Nginx + Certbot**:

   ```bash
   sudo apt install -y nginx certbot python3-certbot-nginx ufw
   sudo ufw allow OpenSSH
   sudo ufw allow 'Nginx Full'
   sudo ufw enable
   ```

   Virtual hosts (API y Web) apuntando a los puertos publicados por tus contenedores.
   Emite certificados:

   ```bash
   sudo certbot --nginx -d tu-dominio.com -d api.tu-dominio.com
   ```
6. **Arrancar**:

   ```bash
   docker compose up -d --build
   ```
7. **Backups de Postgres** (cron):

   ```bash
   mkdir -p ~/db_backups
   crontab -e
   # cada noche 02:00
   0 2 * * * docker compose exec -T postgres pg_dump -U erp_user erp_db > ~/db_backups/erp_db_$(date +\%F).sql
   ```

**Alternativa m√°s simple**: *Caddy reverse proxy* en lugar de Nginx (auto-TLS con DNS correcto).
**Alternativa m√°s directa** (sin proxy): abrir puertos 5173/8000 y usar HTTP plano (no recomendado para prod).

---

## üîí Check de seguridad b√°sico (prod)

* Cambia `SECRET_KEY` y **todas** las contrase√±as.
* Usa `DEBUG=false`.
* Restringe `ALLOWED_ORIGINS` a tu dominio.
* Habilita firewall (UFW) solo 80/443/22.
* Backups diarios y retenci√≥n (7/14/30 d√≠as).

````

---

# Specify.md

```md
# SPECIFY ‚Äî ERP MVP

## Resumen
MVP de ERP enfocado en **gesti√≥n de proyectos y tareas** con **control de acceso por roles**. Permite crear/listar/actualizar proyectos y tareas, gestionar membres√≠as de proyecto, y obtener un **reporte simple por estado**. UI m√≠nima para login, listado b√°sico y verificaci√≥n de salud.

## Objetivo
Entregar una base limpia, **extensible** y **desplegable** que permita evolucionar hacia:
- **Dashboard ejecutivo** con m√©tricas y KPIs operativos.
- Gesti√≥n avanzada de tareas (asignaciones, tiempos, costos).
- Reportes y vistas anal√≠ticas.
- Seguridad, auditor√≠a y trazabilidad.

## Usuarios & Roles
- **Super Admin / Admin**: gesti√≥n global (usuarios, proyectos).
- **Gerente de Proyecto / L√≠der de Equipo**: CRUD de proyectos/tareas, reportes.
- **Colaborador**: lectura y ejecuci√≥n de tareas propias / del proyecto.

## Alcance actual (MVP)
- Autenticaci√≥n JWT + `/auth/refresh`.
- Roles y permisos (guards en API).
- CRUD m√≠nimo de proyectos y tareas.
- Miembros de proyecto (alta/baja, acceso condicionado).
- Reporte por estado (vista `vw_resumen_tareas_por_estado`).
- UI m√≠nima (login + rutas protegidas).

## No-Alcance (MVP)
- UI completa de administraci√≥n.
- Tableros (kanban), notificaciones, comentarios.
- Auditor√≠a, bit√°coras avanzadas.
- Integraciones externas (ERP/BI/SSO).
- M√≥vil / offline.

## Visi√≥n futura
- **Dashboard**: progreso, productividad, costos, ‚Äúanotaciones de m√©tricas‚Äù (p.ej. *metros lineales de bandeja galvanizada por √°rea*), agregaciones temporales, comparativas y desviaciones.
- **Planificaci√≥n**: hitos, dependencias, Gantt b√°sico, criticidad.
- **Colaboraci√≥n**: comentarios/adjuntos/mencciones.
- **Automatizaciones**: recordatorios, SLA, webhooks.
- **Datos**: materialized views y ETL a almac√©n anal√≠tico.
- **Seguridad**: RBAC fino, auditor√≠a, hardening, SSO.

## Restricciones
- SQLAlchemy 2.x, FastAPI.
- Migraciones iniciales por scripts `init-scripts/` (todo ok para dev); en prod se sugiere **Alembic**.
- Stack 100% contenedorizado (Docker Compose).

## M√©tricas de √©xito
- Tiempo de despliegue < 20 min.
- Flujo login ‚Üí crear proyecto ‚Üí crear tareas ‚Üí ver reporte, 100% OK.
- 0 errores en healthcheck y logs limpios al boot.
````

---

# Plan.md

```md
# PLAN ‚Äî Hitos y pr√≥ximos pasos

## Hitos completados (MVP)
1. **Infra local** con Docker Compose: Postgres 16 + pgAdmin + API + Web.
2. **DB**: tablas de usuarios/roles/organizaciones/departamentos/proyectos/tareas + vista agregada + `proyecto_miembros`.
3. **Auth**: login JWT, `/auth/refresh`, guards por roles/permisos.
4. **Projects/Tasks**: endpoints CRUD m√≠nimos + membres√≠as + reporte por estado.
5. **UI m√≠nima**: Login + rutas protegidas + llamadas a health; correcci√≥n import `ProtectedRoute`.
6. **Seeds √∫tiles**: admin + colaboradores de prueba.

## Gap review r√°pido
- UI a√∫n b√°sica (falta listado/tabla/edici√≥n ‚Äúlinda‚Äù).
- Migraciones no gestionadas con Alembic (solo scripts init).
- Falta hardening para prod (SECRET_KEY/HTTPS/backup/monitoring).

## Pr√≥ximos pasos a **pre-producci√≥n**
1. **Alembic** para migraciones (crear carpeta `alembic/`, `env.py`, `script.py.mako`).
2. **UI m√≠nima operable**:
   - Listado de proyectos y tareas con filtros.
   - Crear/editar desde UI + **refresco instant√°neo** de listas (React Query).
   - Cambio libre de estado de tareas (no solo ‚ÄúHECHA‚Äù).
3. **Dashboard MVP**:
   - Tarjetas: proyectos activos, tareas por estado, √∫ltimas anotaciones.
   - Gr√°fico simple (Recharts) por progreso/estado.
4. **Seguridad y prod**:
   - SECRET_KEY/creds fuertes, `DEBUG=false`, CORS dominio.
   - Nginx + Certbot; backups cron de Postgres.
5. **Observabilidad**:
   - Access/error logs centralizados.
   - Healthcheck + endpoint `/metrics` (opcional con Prometheus FastAPI).

## Roadmap a **producci√≥n**
- **UI full** (role-based): p√°ginas de admin, permisos granulares.
- **Dashboard ejecutivo** con KPIs (tiempos, costos, avance vs plan).
- **Anotaciones/mediciones** (modelo y UI) + agregados por proyecto/√°rea/tiempo.
- **Notificaciones** (email/webhooks).
- **Auditor√≠a** (tabla de eventos, qui√©n cambi√≥ qu√©/cu√°ndo).
- **CI/CD** (GitHub Actions: build + test + push images + deploy).
```

---

# Tasks.md

```md
# TASKS ‚Äî backlog accionable

## A) Infra / Base de datos
1. **Alembic setup** (S): inicializar proyecto y primera migraci√≥n desde esquema actual.
2. **Seeds en Alembic** (M): convertir seeds a ‚Äúmigraciones de datos‚Äù idempotentes (roles/admin).
3. **Backups** (S): script `pg_dump` diario + retenci√≥n (cron).
4. **Indices & tuning** (M): revisar EXPLAIN en listados y vistas.

## B) API
5. **Endpoints UI-ready** (S): asegurar respuestas limpias y errores consistentes.
6. **Estados de tarea** (S): validar enum (`PENDIENTE|EN_PROGRESO|HECHA|BLOQUEADA|CANCELADA`).
7. **Members API** (S): ya funcional; sumar paginaci√≥n/filtros (opcional).
8. **Reporte extendido** (M): endpoint de KPIs simples por proyecto (conteos + %).

## C) UI (React + Vite)
9. **Auth flow** (S): form login + guardar token + `/auth/refresh`.
10. **State/query** (S): integrar **TanStack Query** para fetch/cache/invalidations.
11. **Proyectos** (M): listado, crear/editar, **refrescar tras mutaciones**.
12. **Tareas** (M): listado por proyecto, crear/editar, cambio libre de estado, **refrescar**.
13. **Dashboard MVP** (M): tarjetas + gr√°fico Recharts con datos reales.
14. **Estilos base** (S): aplicar `styles.css` (tiny CSS adjunto).

## D) Seguridad / Prod
15. **SECRET_KEY + creds** (S): rotar y ocultar.
16. **CORS dominio** (S): `ALLOWED_ORIGINS="https://tu-dominio.com"`.
17. **Nginx + TLS** (M): conf. reverse proxy + Certbot.
18. **UFW** (S): solo 22/80/443.
19. **Monitoreo b√°sico** (S): logs y alertas simples (disk full, container restart).

## E) Dashboard & M√©tricas (feature)
20. **Modelo ‚Äúanotaciones‚Äù** (M): `metric_logs(id, proyecto_id, area, tipo, unidad, cantidad, fecha, notas)`.
21. **API anotaciones** (M): CRUD + agregados por proyecto/√°rea/mes.
22. **UI anotaciones** (M): form r√°pido + tabla con filtros.
23. **Widgets dashboard** (M): total por tipo/unidad (p.ej. ‚Äúm bandeja galvanizada‚Äù), l√≠neas de tiempo.
24. **Materialized view** (M): resumen por d√≠a/semana para rendimiento en reportes.

> S=Small (‚â§0.5d) / M=Medium (‚â§2d) / L=Large (>2d) ‚Äî Ajusta a tu ritmo.
```

---

# Gu√≠a modular para aprender y ampliar (con ejemplo del dashboard/‚Äúanotaciones‚Äù)

**Objetivo:** que puedas agregar features **vos mismo** con apoyo de IA.

## M√≥dulo 1 ‚Äî Base del stack (1‚Äì2 d√≠as)

* **Docker & Compose**: redes, vol√∫menes, logs.
* **FastAPI**: routers, dependencias, pydantic v2, manejo de errores.
* **SQLAlchemy 2.x**: ORM moderno, `selectinload`, sesiones async.
* **JWT**: access vs refresh, expiraci√≥n, guardas en rutas.
* **React + Vite + TS**: hooks, rutas, componentes controlados.

## M√≥dulo 2 ‚Äî Data & API (2‚Äì3 d√≠as)

* **Modelado**: entidades y relaciones b√°sicas; vistas SQL.
* **Migrations**: **Alembic** (indispensable para prod).
* **Consultas**: filtros, paginaci√≥n, agregaciones.
* **Pruebas**: `pytest` + `httpx` para endpoints cr√≠ticos.

## M√≥dulo 3 ‚Äî UI productiva (2‚Äì3 d√≠as)

* **TanStack Query**: `useQuery`/`useMutation` + **invalidations para refrescar** tras crear/editar.
* **Forms**: controlled inputs, validaci√≥n m√≠nima, UX.
* **Componentes**: tablas, paginaci√≥n, toasts, loaders.
* **Autorizaci√≥n**: ProtectedRoute, ocultar acciones por rol.

## M√≥dulo 4 ‚Äî Dashboards & Reporting (2‚Äì3 d√≠as)

* **Recharts**: barras/l√≠neas/pie para KPIs simples.
* **Vistas/materialized**: pre-agregados por fecha/proyecto.
* **Dise√±o de m√©tricas**: *tipo* (ej. ‚Äúbandeja galvanizada‚Äù), *unidad* (m), *cantidad*, *√°rea* (4110), *fecha*.

## M√≥dulo 5 ‚Äî Prod & Seguridad (2‚Äì3 d√≠as)

* **Nginx + TLS** con Certbot; CORS; logs y backups.
* **Hardening**: secretos, m√≠nimos privilegios, UFW.

### Ejemplo concreto: ‚ÄúAnotaciones de tareas clave / m√©tricas‚Äù

1. **DB** (nueva tabla):

   ```sql
   CREATE TABLE metric_logs (
     id SERIAL PRIMARY KEY,
     proyecto_id INT NOT NULL REFERENCES proyectos(id) ON DELETE CASCADE,
     area TEXT NOT NULL,            -- ej. "4110"
     tipo TEXT NOT NULL,            -- ej. "bandeja_galvanizada"
     unidad TEXT NOT NULL,          -- ej. "m"
     cantidad NUMERIC(12,2) NOT NULL,
     fecha DATE NOT NULL DEFAULT CURRENT_DATE,
     notas TEXT,
     created_at TIMESTAMPTZ DEFAULT now()
   );
   CREATE INDEX idx_metric_logs_proyecto_fecha ON metric_logs(proyecto_id, fecha);
   ```
2. **API**:

   * `POST /api/metrics` (crear anotaci√≥n)
   * `GET /api/metrics?proyecto_id=&area=&tipo=&from=&to=` (listar/filtrar)
   * `GET /api/metrics/summary?proyecto_id=&group_by=area|tipo|fecha` (agregados)
3. **UI**:

   * Form simple: proyecto, √°rea, tipo, unidad, cantidad, fecha, notas.
   * Tabla filtrable por proyecto/√°rea/fecha.
   * **Dashboard**: tarjeta ‚ÄúTotal m bandeja (√°rea 4110) este mes‚Äù, gr√°fico de barras por d√≠a/semana.
4. **TanStack Query**:

   * `useMutation(createMetric)` + `queryClient.invalidateQueries(['metrics', filters])` para refrescar.
5. **Vistas**:

   ```sql
   CREATE MATERIALIZED VIEW mv_metrics_daily AS
   SELECT proyecto_id, area, tipo, unidad, fecha, SUM(cantidad)::numeric(12,2) total
   FROM metric_logs
   GROUP BY 1,2,3,4,5;
   -- REFRESH MATERIALIZED VIEW mv_metrics_daily;
   ```

> Con esto ten√©s el esqueleto para tu dashboard ejecutivo con ‚Äúanotaciones‚Äù.

---

# Tiny CSS (r√°pido y sobrio)

Crea `web/src/styles.css` y **en `main.tsx`** importa `import "./styles.css";`

```css
/* web/src/styles.css */
:root {
  --bg: #0f172a;         /* slate-900 */
  --card: #111827;       /* gray-900 */
  --muted: #475569;      /* slate-500 */
  --text: #e5e7eb;       /* gray-200 */
  --primary: #22d3ee;    /* cyan-400 */
  --danger: #ef4444;
  --ok: #22c55e;
  --border: #1f2937;     /* gray-800 */
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; }
body {
  margin: 0;
  background: linear-gradient(180deg, #0b1220 0%, #0f172a 100%);
  color: var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, 'Helvetica Neue', Arial;
}

.container { max-width: 1100px; margin: 24px auto; padding: 0 16px; }

.card {
  background: rgba(17,24,39,0.85);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 18px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  backdrop-filter: blur(6px);
}

h1,h2,h3 { margin: 8px 0 16px; }
h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; color: var(--muted); }

label { display:block; font-size:.9rem; color: var(--muted); margin-bottom: 6px; }
input, select, textarea {
  width: 100%;
  background: #0b1220;
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 12px;
  outline: none;
}
input:focus, select:focus, textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(34,211,238,.15);
}

.row { display: grid; gap: 12px; grid-template-columns: repeat(12,1fr); }
.col-6 { grid-column: span 6; } .col-4 { grid-column: span 4; } .col-12 { grid-column: span 12; }

.btn {
  display:inline-flex; align-items:center; gap:8px;
  padding: 10px 14px; border-radius: 12px;
  border: 1px solid var(--border);
  background: #0b1220; color: var(--text);
  cursor: pointer; text-decoration: none;
}
.btn:hover { border-color: var(--primary); }
.btn.primary { background: linear-gradient(90deg, #06b6d4, #22d3ee); color:#001018; font-weight:600; }
.btn.danger { background: #221216; border-color: #401016; color: #ffd6d6; }

.table { width: 100%; border-collapse: collapse; }
.table th, .table td { padding: 10px 12px; border-bottom: 1px solid var(--border); }
.table th { color: var(--muted); font-weight: 600; text-align: left; }
.badge { padding: 2px 8px; border-radius: 999px; border:1px solid var(--border); font-size: .8rem; }
.badge.ok { color: var(--ok); border-color: rgba(34,197,94,.5); }
.badge.warn { color: #f59e0b; border-color: rgba(245,158,11,.5); }
.badge.danger { color: var(--danger); border-color: rgba(239,68,68,.5); }
```

> Con esto ya se ve prolijo sin meter librer√≠as.

---

## ¬øQu√© archivos est√°n ‚Äúal pedo‚Äù?

En el dump m√°s reciente el set luce bastante coherente. Lo √∫nico a vigilar/limpiar peri√≥dicamente:

* `init-scripts/02-datos-iniciales.sql` (solo asegura extensi√≥n): puedes fusionarlo con `01-schema.sql` si quer√©s menos archivos.
* Revisa que **no** queden `*.log`, `dist/`, `build/`, `.vite/` (ya ignorados).
* En `api/app/auth/routes.py` hay imports duplicados (dos veces `verify_password, get_password_hash, ...` y `RefreshTokenRequest`). No rompe, pero **limpiarlos** es sano.

---

## Estado final del checkpoint

* **MVP local** ‚úÖ listo.
* **API** estable con auth/refresh, proyectos/tareas/miembros/reportes.
* **UI m√≠nima** ‚úÖ, con `ProtectedRoute` corregido; queda pendiente listado/edici√≥n ‚Äúlindo‚Äù y **refrescos tras crear/editar** usando React Query (lo dej√© en el Tasks.md).
* **Deploy**: gu√≠a completa arriba.

Si quer√©s, en un siguiente paso te doy el esqueleto de:

* **alembic init + primera migraci√≥n**, y
* **endpoints/TS** para ‚Äúanotaciones‚Äù + **widgets de dashboard** base.

Pero por ahora, con lo de arriba, **MVP: ‚úîÔ∏è FINALIZADO**.


---
script-copiar-todo.ps1

# --- Configuraci√≥n ---
# Nombre del archivo de salida que se crear√° en el directorio ra√≠z.
$outputFile = "output.txt"

# Lista de directorios que se ignorar√°n por completo.
$excludedDirs = @(
    'pgdata',
    'appsmith-stacks',
    'node_modules',
    '__pycache__',
    '.vite',
    '.git',      # Se a√±ade .git por si es un repositorio.
    'dist',      # Se a√±ade dist por si hay builds.
    'build'
)

# Lista de extensiones de archivo que se ignorar√°n.
$excludedExtensions = @(
    '.log',
    '.lock',
    '.svg',
    '.png',
    '.jpg',
    '.jpeg',
    '.gif',
    '.ico'
    '.txt'
)


# --- Comienzo del Script ---

# Limpiar el archivo de salida si ya existe.
if (Test-Path $outputFile) {
    Clear-Content $outputFile
}

Write-Host "Generando listado de archivos en '$outputFile'..."

# Obtener la ruta completa del directorio actual para crear rutas relativas.
$rootPath = (Get-Location).Path
if (-not $rootPath.EndsWith('\')) {
    $rootPath += '\'
}
$rootPathLength = $rootPath.Length

# Obtener todos los archivos de forma recursiva.
Get-ChildItem -Path . -Recurse -File | ForEach-Object {
    $file = $_
    $shouldExclude = $false

    # 1. Comprobar si el archivo est√° en un directorio excluido.
    foreach ($dir in $excludedDirs) {
        if ($file.FullName -like "*\$dir\*") {
            $shouldExclude = $true
            break
        }
    }

    # 2. Comprobar si la extensi√≥n del archivo est√° excluida (si no fue ya excluido por directorio).
    if (-not $shouldExclude) {
        if ($excludedExtensions -contains $file.Extension) {
            $shouldExclude = $true
        }
    }

    # 3. Excluir el propio archivo de salida.
    if ($file.Name -eq $outputFile) {
        $shouldExclude = $true
    }

    # Si el archivo no debe ser excluido, procesarlo.
    if (-not $shouldExclude) {
        # Obtener la ruta relativa del archivo.
        $relativePath = $file.FullName.Substring($rootPathLength)

        Write-Host "Procesando: $relativePath"

        # Leer el contenido del archivo. Se a√±ade un try-catch por si es un archivo binario.
        $content = ""
        try {
            $content = Get-Content -Path $file.FullName -Raw -ErrorAction Stop
        } catch {
            $content = "### ERROR: No se pudo leer el contenido del archivo (posiblemente binario). ###"
        }

        # Crear el bloque de texto con el formato solicitado.
        $outputBlock = @"
$relativePath

$content

---
"@

        # A√±adir el bloque al archivo de salida.
        Add-Content -Path $outputFile -Value $outputBlock
    }
}

Write-Host "¬°Proceso completado! El archivo '$outputFile' ha sido creado con √©xito."

---
Specify.md

# SPECIFY ‚Äî ERP MVP

## Resumen
MVP de ERP enfocado en **gesti√≥n de proyectos y tareas** con **control de acceso por roles**. Permite crear/listar/actualizar proyectos y tareas, gestionar membres√≠as de proyecto, y obtener un **reporte simple por estado**. UI m√≠nima para login, listado b√°sico y verificaci√≥n de salud.

## Objetivo
Entregar una base limpia, **extensible** y **desplegable** que permita evolucionar hacia:
- **Dashboard ejecutivo** con m√©tricas y KPIs operativos.
- Gesti√≥n avanzada de tareas (asignaciones, tiempos, costos).
- Reportes y vistas anal√≠ticas.
- Seguridad, auditor√≠a y trazabilidad.

## Usuarios & Roles
- **Super Admin / Admin**: gesti√≥n global (usuarios, proyectos).
- **Gerente de Proyecto / L√≠der de Equipo**: CRUD de proyectos/tareas, reportes.
- **Colaborador**: lectura y ejecuci√≥n de tareas propias / del proyecto.

## Alcance actual (MVP)
- Autenticaci√≥n JWT + `/auth/refresh`.
- Roles y permisos (guards en API).
- CRUD m√≠nimo de proyectos y tareas.
- Miembros de proyecto (alta/baja, acceso condicionado).
- Reporte por estado (vista `vw_resumen_tareas_por_estado`).
- UI m√≠nima (login + rutas protegidas).

## No-Alcance (MVP)
- UI completa de administraci√≥n.
- Tableros (kanban), notificaciones, comentarios.
- Auditor√≠a, bit√°coras avanzadas.
- Integraciones externas (ERP/BI/SSO).
- M√≥vil / offline.

## Visi√≥n futura
- **Dashboard**: progreso, productividad, costos, ‚Äúanotaciones de m√©tricas‚Äù (p.ej. *metros lineales de bandeja galvanizada por √°rea*), agregaciones temporales, comparativas y desviaciones.
- **Planificaci√≥n**: hitos, dependencias, Gantt b√°sico, criticidad.
- **Colaboraci√≥n**: comentarios/adjuntos/mencciones.
- **Automatizaciones**: recordatorios, SLA, webhooks.
- **Datos**: materialized views y ETL a almac√©n anal√≠tico.
- **Seguridad**: RBAC fino, auditor√≠a, hardening, SSO.

## Restricciones
- SQLAlchemy 2.x, FastAPI.
- Migraciones iniciales por scripts `init-scripts/` (todo ok para dev); en prod se sugiere **Alembic**.
- Stack 100% contenedorizado (Docker Compose).

## M√©tricas de √©xito
- Tiempo de despliegue < 20 min.
- Flujo login ‚Üí crear proyecto ‚Üí crear tareas ‚Üí ver reporte, 100% OK.
- 0 errores en healthcheck y logs limpios al boot.
````


---
Tasks.md

# TASKS ‚Äî backlog accionable

## A) Infra / Base de datos
1. **Alembic setup** (S): inicializar proyecto y primera migraci√≥n desde esquema actual.
2. **Seeds en Alembic** (M): convertir seeds a ‚Äúmigraciones de datos‚Äù idempotentes (roles/admin).
3. **Backups** (S): script `pg_dump` diario + retenci√≥n (cron).
4. **Indices & tuning** (M): revisar EXPLAIN en listados y vistas.

## B) API
5. **Endpoints UI-ready** (S): asegurar respuestas limpias y errores consistentes.
6. **Estados de tarea** (S): validar enum (`PENDIENTE|EN_PROGRESO|HECHA|BLOQUEADA|CANCELADA`).
7. **Members API** (S): ya funcional; sumar paginaci√≥n/filtros (opcional).
8. **Reporte extendido** (M): endpoint de KPIs simples por proyecto (conteos + %).

## C) UI (React + Vite)
9. **Auth flow** (S): form login + guardar token + `/auth/refresh`.
10. **State/query** (S): integrar **TanStack Query** para fetch/cache/invalidations.
11. **Proyectos** (M): listado, crear/editar, **refrescar tras mutaciones**.
12. **Tareas** (M): listado por proyecto, crear/editar, cambio libre de estado, **refrescar**.
13. **Dashboard MVP** (M): tarjetas + gr√°fico Recharts con datos reales.
14. **Estilos base** (S): aplicar `styles.css` (tiny CSS adjunto).

## D) Seguridad / Prod
15. **SECRET_KEY + creds** (S): rotar y ocultar.
16. **CORS dominio** (S): `ALLOWED_ORIGINS="https://tu-dominio.com"`.
17. **Nginx + TLS** (M): conf. reverse proxy + Certbot.
18. **UFW** (S): solo 22/80/443.
19. **Monitoreo b√°sico** (S): logs y alertas simples (disk full, container restart).

## E) Dashboard & M√©tricas (feature)
20. **Modelo ‚Äúanotaciones‚Äù** (M): `metric_logs(id, proyecto_id, area, tipo, unidad, cantidad, fecha, notas)`.
21. **API anotaciones** (M): CRUD + agregados por proyecto/√°rea/mes.
22. **UI anotaciones** (M): form r√°pido + tabla con filtros.
23. **Widgets dashboard** (M): total por tipo/unidad (p.ej. ‚Äúm bandeja galvanizada‚Äù), l√≠neas de tiempo.
24. **Materialized view** (M): resumen por d√≠a/semana para rendimiento en reportes.

> S=Small (‚â§0.5d) / M=Medium (‚â§2d) / L=Large (>2d) ‚Äî Ajusta a tu ritmo.

---
api\.env

# api/.env
APP_NAME="ERP API"
VERSION="1.0.0"
DESCRIPTION="Sistema de Gesti√≥n Empresarial - API Backend"

DATABASE_URL="postgresql+asyncpg://erp_user:erp_password123@postgres:5432/erp_db"
DATABASE_URL_SYNC="postgresql://erp_user:erp_password123@postgres:5432/erp_db"

HOST="0.0.0.0"
PORT=8000
DEBUG=true

SECRET_KEY="cambia-esto-en-produccion"
ALGORITHM="HS256"
ACCESS_TOKEN_EXPIRE_MINUTES=30

ALLOWED_ORIGINS="http://localhost:3000,http://127.0.0.1:3000,http://localhost:8080,http://127.0.0.1:8080,http://localhost:5173,http://127.0.0.1:5173"

MAX_UPLOAD_SIZE=10485760
ITEMS_PER_PAGE=50


---
api\Dockerfile

# api/Dockerfile
FROM python:3.11-slim

WORKDIR /app

RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential gcc libpq-dev \
 && rm -rf /var/lib/apt/lists/*

COPY requirements.txt ./requirements.txt
RUN pip install -r requirements.txt

COPY app ./app

EXPOSE 8000
CMD ["uvicorn", "app.main:app", "--host","0.0.0.0","--port","8000","--reload"]


---
api\app\config.py

# api/app/config.py
from typing import List
from pydantic import Field, AliasChoices
from pydantic_settings import BaseSettings, SettingsConfigDict
import json

DEFAULT_ORIGINS = [
    "http://localhost:3000",
    "http://127.0.0.1:3000",
    "http://localhost:8080",
    "http://127.0.0.1:8080",
]

class Settings(BaseSettings):
    model_config = SettingsConfigDict(
        env_file=".env",
        case_sensitive=True,
        extra="ignore",
    )

    # --- App info ---
    app_name: str = Field("ERP API", validation_alias=AliasChoices("APP_NAME", "app_name"))
    version: str = Field("1.0.0", validation_alias=AliasChoices("VERSION", "version"))
    description: str = Field(
        "Sistema de Gesti√≥n Empresarial - API Backend",
        validation_alias=AliasChoices("DESCRIPTION", "description"),
    )

    # --- DB (ojo: host 'postgres' es el nombre del servicio en docker-compose) ---
    database_url: str = Field(
        "postgresql+asyncpg://erp_user:erp_password123@postgres:5432/erp_db",
        validation_alias=AliasChoices("DATABASE_URL", "database_url")
    )
    database_url_sync: str = Field(
        "postgresql://erp_user:erp_password123@postgres:5432/erp_db",
        validation_alias=AliasChoices("DATABASE_URL_SYNC", "database_url_sync")
    )

    # --- Server ---
    host: str = Field("0.0.0.0", validation_alias=AliasChoices("HOST", "host"))
    port: int = Field(8000, validation_alias=AliasChoices("PORT", "port"))
    debug: bool = Field(True, validation_alias=AliasChoices("DEBUG", "debug"))

    # --- Security ---
    secret_key: str = Field("cambia-esto-en-produccion", validation_alias=AliasChoices("SECRET_KEY", "secret_key"))
    algorithm: str = Field("HS256", validation_alias=AliasChoices("ALGORITHM", "algorithm"))
    access_token_expire_minutes: int = Field(
        30, validation_alias=AliasChoices("ACCESS_TOKEN_EXPIRE_MINUTES", "access_token_expire_minutes")
    )

    # --- CORS ---
    # Leer como string crudo y convertir a lista (soporta JSON o CSV)
    allowed_origins_raw: str = Field(
        "", validation_alias=AliasChoices("ALLOWED_ORIGINS", "allowed_origins")
    )

    # --- Misc ---
    max_upload_size: int = Field(10 * 1024 * 1024, validation_alias=AliasChoices("MAX_UPLOAD_SIZE", "max_upload_size"))
    items_per_page: int = Field(50, validation_alias=AliasChoices("ITEMS_PER_PAGE", "items_per_page"))

    @property
    def allowed_origins(self) -> List[str]:
        v = (self.allowed_origins_raw or "").strip()
        if not v:
            return DEFAULT_ORIGINS
        # 1) intenta JSON
        try:
            data = json.loads(v)
            if isinstance(data, list):
                return [str(x).strip() for x in data if str(x).strip()]
        except Exception:
            pass
        # 2) fallback CSV
        return [s.strip() for s in v.split(",") if s.strip()]

settings = Settings()

def get_database_url() -> str:
    return settings.database_url

def get_database_url_sync() -> str:
    return settings.database_url_sync


---
api\app\database.py

# api/app/database.py
import logging
from sqlalchemy import create_engine, MetaData, text
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker, declarative_base
from .config import settings

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# --- Motores ---
async_engine = create_async_engine(
    settings.database_url,
    echo=settings.debug,
    pool_pre_ping=True,
    pool_recycle=300,
)

sync_engine = create_engine(
    settings.database_url_sync,
    echo=settings.debug,
    pool_pre_ping=True,
    pool_recycle=300,
)

# --- Sesiones ---
AsyncSessionLocal = sessionmaker(
    bind=async_engine,
    class_=AsyncSession,
    expire_on_commit=False,
)

SessionLocal = sessionmaker(
    bind=sync_engine,
    autocommit=False,
    autoflush=False,
)

# --- Base & metadata ---
Base = declarative_base()
metadata = MetaData()


async def get_async_db() -> AsyncSession:
    """
    Dependency: sesi√≥n async
    """
    async with AsyncSessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise


def get_db():
    """
    Dependency: sesi√≥n sync
    """
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


async def init_db():
    """
    Refleja tablas existentes y valida la conexi√≥n.
    """
    try:
        async with async_engine.begin() as conn:
            # Ejecuta la reflexi√≥n en el hilo sync del engine async
            await conn.run_sync(lambda sc: metadata.reflect(bind=sc))
            logger.info("‚úÖ Conexi√≥n a PostgreSQL OK")
            logger.info(f"üìä Tablas encontradas: {len(metadata.tables)}")
            if metadata.tables:
                logger.info(f"üìã {', '.join(list(metadata.tables.keys()))}")
    except Exception as e:
        logger.error(f"‚ùå Error al conectar/reflejar DB: {e}")
        raise


async def close_db():
    try:
        await async_engine.dispose()
        sync_engine.dispose()
        logger.info("‚úÖ Conexiones DB cerradas")
    except Exception as e:
        logger.error(f"‚ùå Error al cerrar DB: {e}")


async def test_connection() -> bool:
    """
    SELECT 1 usando SQLAlchemy 2.0 (text()).
    """
    try:
        async with AsyncSessionLocal() as session:
            result = await session.execute(text("SELECT 1"))
            return result.scalar() == 1
    except Exception as e:
        logger.error(f"‚ùå Test de conexi√≥n fall√≥: {e}")
        return False


---
api\app\main.py

# api/app/main.py

from fastapi import FastAPI, HTTPException, status
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
from contextlib import asynccontextmanager
from datetime import datetime, timezone
import logging
import uvicorn

from .config import settings
from .database import init_db, close_db, test_connection

# Importar todos los modelos para que SQLAlchemy los registre
from .auth import models as auth_models
from .projects import models as project_models

from .auth.routes import auth_router
from .projects.routes import router as projects_router

logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s")
logger = logging.getLogger(__name__)


@asynccontextmanager
async def lifespan(app: FastAPI):
    logger.info("üöÄ Iniciando ERP API...")
    try:
        await init_db()
        if await test_connection():
            logger.info("‚úÖ Base de datos conectada correctamente")
        else:
            logger.error("‚ùå Error en la conexi√≥n a la base de datos")
    except Exception as e:
        logger.error(f"‚ùå Error durante el startup: {str(e)}")
        raise
    logger.info("üéâ ERP API iniciada correctamente")
    yield
    logger.info("üîÑ Cerrando ERP API...")
    await close_db()
    logger.info("‚úÖ ERP API cerrada correctamente")


app = FastAPI(
    title=settings.app_name,
    version=settings.version,
    description=settings.description,
    lifespan=lifespan,
    docs_url="/docs",
    redoc_url="/redoc",
    openapi_url="/openapi.json"
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.allowed_origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)


@app.exception_handler(HTTPException)
async def http_exception_handler(request, exc: HTTPException):
    return JSONResponse(status_code=exc.status_code, content={
        "detail": exc.detail,
        "status_code": exc.status_code,
        "success": False
    })


@app.exception_handler(Exception)
async def general_exception_handler(request, exc: Exception):
    logger.error(f"Error no controlado: {str(exc)}")
    return JSONResponse(status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, content={
        "detail": "Error interno del servidor",
        "status_code": 500,
        "success": False
    })


@app.get("/")
async def root():
    return {
        "message": "ERP System API",
        "version": settings.version,
        "status": "active",
        "docs": "/docs",
        "redoc": "/redoc"
    }


@app.get("/health")
async def health_check():
    try:
        db_status = await test_connection()
        return {
            "status": "healthy" if db_status else "unhealthy",
            "database": "connected" if db_status else "disconnected",
            "version": settings.version,
            "timestamp": datetime.now(timezone.utc).isoformat()
        }
    except Exception as e:
        logger.error(f"Error en health check: {str(e)}")
        return JSONResponse(
            status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
            content={"status": "unhealthy", "database": "error", "error": str(e), "version": settings.version}
        )


# Routers
app.include_router(auth_router, prefix="/api/auth", tags=["Authentication"], responses={401: {"description": "Unauthorized"}, 403: {"description": "Forbidden"}})
app.include_router(projects_router, prefix="/api/projects", tags=["Projects & Tasks"])


def start_server():
    uvicorn.run(
        "app.main:app",
        host=settings.host,
        port=settings.port,
        reload=settings.debug,
        log_level="info"
    )


if __name__ == "__main__":
    start_server()

---
api\app\__init__.py



---
api\app\auth\models.py

"""
Modelos SQLAlchemy para autenticaci√≥n (relaciones desambiguadas)
"""
from sqlalchemy import Column, Integer, String, Boolean, DateTime, Text, ForeignKey
from sqlalchemy.dialects.postgresql import UUID
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
from ..database import Base
import uuid


class Usuario(Base):
    __tablename__ = "usuarios"

    id = Column(Integer, primary_key=True, index=True)
    uuid = Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, index=True)
    email = Column(String(255), unique=True, index=True, nullable=False)
    password_hash = Column(String(255), nullable=False)
    nombre = Column(String(100), nullable=False)
    apellido = Column(String(100), nullable=False)
    telefono = Column(String(20))
    activo = Column(Boolean, default=True)
    ultimo_login = Column(DateTime(timezone=True))
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    # ---- Relaciones con Roles ----
    # Asignaciones (tabla puente) para crear/borrar
    usuario_roles = relationship(
        "UsuarioRol",
        back_populates="usuario",
        foreign_keys="UsuarioRol.usuario_id",
        cascade="all, delete-orphan",
        lazy="selectin",
        overlaps="usuario,usuarios,roles"
    )
    # Vista M2M de roles (solo lectura)
    roles = relationship(
        "Rol",
        secondary="usuario_roles",
        primaryjoin="Usuario.id == UsuarioRol.usuario_id",
        secondaryjoin="Rol.id == UsuarioRol.rol_id",
        back_populates="usuarios",
        viewonly=True,
        lazy="selectin",
        overlaps="usuario_roles,usuarios"
    )

    # ---- Relaciones con Departamentos ----
    usuario_departamentos = relationship(
        "UsuarioDepartamento",
        back_populates="usuario",
        foreign_keys="UsuarioDepartamento.usuario_id",
        cascade="all, delete-orphan",
        lazy="selectin",
        overlaps="usuario,usuarios,departamentos"
    )
    departamentos = relationship(
        "Departamento",
        secondary="usuario_departamentos",
        primaryjoin="Usuario.id == UsuarioDepartamento.usuario_id",
        secondaryjoin="Departamento.id == UsuarioDepartamento.departamento_id",
        back_populates="usuarios",
        viewonly=True,
        lazy="selectin",
        overlaps="usuario_departamentos,usuarios"
    )

    def __repr__(self):
        return f"<Usuario(id={self.id}, email='{self.email}', nombre='{self.nombre}')>"

    @property
    def nombre_completo(self) -> str:
        return f"{self.nombre} {self.apellido}"


class Rol(Base):
    __tablename__ = "roles"

    id = Column(Integer, primary_key=True, index=True)
    nombre = Column(String(50), unique=True, nullable=False)
    descripcion = Column(Text)
    activo = Column(Boolean, default=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    # Asignaciones (tabla puente)
    usuario_roles = relationship(
        "UsuarioRol",
        back_populates="rol",
        lazy="selectin",
        cascade="all, delete-orphan",
        overlaps="rol,roles,usuarios"
    )
    # Usuarios con este rol (solo lectura)
    usuarios = relationship(
        "Usuario",
        secondary="usuario_roles",
        primaryjoin="Rol.id == UsuarioRol.rol_id",
        secondaryjoin="Usuario.id == UsuarioRol.usuario_id",
        back_populates="roles",
        viewonly=True,
        lazy="selectin",
        overlaps="usuario_roles,roles"
    )

    def __repr__(self):
        return f"<Rol(id={self.id}, nombre='{self.nombre}')>"


class UsuarioRol(Base):
    __tablename__ = "usuario_roles"

    id = Column(Integer, primary_key=True, index=True)
    usuario_id = Column(Integer, ForeignKey("usuarios.id", ondelete="CASCADE"), nullable=False)
    rol_id = Column(Integer, ForeignKey("roles.id", ondelete="CASCADE"), nullable=False)
    asignado_por = Column(Integer, ForeignKey("usuarios.id"))
    created_at = Column(DateTime(timezone=True), server_default=func.now())

    # Relaciones
    usuario = relationship(
        "Usuario",
        foreign_keys=[usuario_id],
        back_populates="usuario_roles",
        overlaps="roles,usuarios"
    )
    rol = relationship(
        "Rol",
        back_populates="usuario_roles",
        overlaps="usuarios,roles"
    )
    asignado_por_usuario = relationship(
        "Usuario",
        foreign_keys=[asignado_por]
    )

    def __repr__(self):
        return f"<UsuarioRol(usuario_id={self.usuario_id}, rol_id={self.rol_id})>"


class Organizacion(Base):
    __tablename__ = "organizaciones"

    id = Column(Integer, primary_key=True, index=True)
    uuid = Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, index=True)
    nombre = Column(String(255), nullable=False)
    razon_social = Column(String(255))
    rfc = Column(String(20))
    telefono = Column(String(20))
    email = Column(String(255))
    direccion = Column(Text)
    ciudad = Column(String(100))
    estado = Column(String(100))
    codigo_postal = Column(String(10))
    pais = Column(String(100), default="Argentina")
    activa = Column(Boolean, default=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    departamentos = relationship("Departamento", back_populates="organizacion", lazy="selectin")

    def __repr__(self):
        return f"<Organizacion(id={self.id}, nombre='{self.nombre}')>"


class Departamento(Base):
    __tablename__ = "departamentos"

    id = Column(Integer, primary_key=True, index=True)
    uuid = Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, index=True)
    nombre = Column(String(100), nullable=False)
    descripcion = Column(Text)
    organizacion_id = Column(Integer, ForeignKey("organizaciones.id", ondelete="CASCADE"))
    departamento_padre_id = Column(Integer, ForeignKey("departamentos.id"))
    responsable_id = Column(Integer, ForeignKey("usuarios.id"))
    activo = Column(Boolean, default=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    organizacion = relationship("Organizacion", back_populates="departamentos", lazy="joined")
    responsable = relationship("Usuario")
    departamento_padre = relationship("Departamento", remote_side="Departamento.id")
    # Asignaciones (tabla puente)
    usuarios_asignaciones = relationship(
        "UsuarioDepartamento",
        back_populates="departamento",
        lazy="selectin",
        cascade="all, delete-orphan",
        overlaps="departamento,usuarios"
    )
    # Usuarios (solo lectura)
    usuarios = relationship(
        "Usuario",
        secondary="usuario_departamentos",
        primaryjoin="Departamento.id == UsuarioDepartamento.departamento_id",
        secondaryjoin="Usuario.id == UsuarioDepartamento.usuario_id",
        back_populates="departamentos",
        viewonly=True,
        lazy="selectin",
        overlaps="usuarios_asignaciones,departamentos"
    )

    def __repr__(self):
        return f"<Departamento(id={self.id}, nombre='{self.nombre}')>"


class UsuarioDepartamento(Base):
    __tablename__ = "usuario_departamentos"

    id = Column(Integer, primary_key=True, index=True)
    usuario_id = Column(Integer, ForeignKey("usuarios.id", ondelete="CASCADE"))
    departamento_id = Column(Integer, ForeignKey("departamentos.id", ondelete="CASCADE"))
    es_responsable = Column(Boolean, default=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())

    usuario = relationship(
        "Usuario",
        back_populates="usuario_departamentos",
        foreign_keys=[usuario_id],
        overlaps="departamentos,usuarios"
    )
    departamento = relationship(
        "Departamento",
        back_populates="usuarios_asignaciones",
        foreign_keys=[departamento_id],
        overlaps="usuarios,departamentos"
    )

    def __repr__(self):
        return f"<UsuarioDepartamento(usuario_id={self.usuario_id}, departamento_id={self.departamento_id})>"


---
api\app\auth\routes.py

"""
Rutas de autenticaci√≥n
"""
from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy.orm import selectinload
from sqlalchemy import select, and_
from datetime import datetime, timezone
from typing import List
import logging

from ..database import get_async_db
from ..utils.security import (
    verify_password, get_password_hash,
    create_access_token, create_refresh_token,
    get_user_id_from_refresh_token
)
from ..utils.dependencies import get_current_active_user, require_roles, get_pagination, Pagination
from ..config import settings
from .models import Usuario, Rol, UsuarioRol
from .schemas import (
    LoginRequest, LoginResponse, UsuarioCreate, UsuarioUpdate, UsuarioResponse,
    MessageResponse, ChangePasswordRequest, RolCreate, RolResponse, RolUpdate,
    RefreshTokenRequest
)
from jose import JWTError
from ..utils.security import verify_password, get_password_hash, create_access_token, create_refresh_token, get_user_id_from_refresh_token
from .schemas import RefreshTokenRequest, TokenRefreshResponse

logger = logging.getLogger(__name__)

auth_router = APIRouter()


@auth_router.post("/login", response_model=LoginResponse)
async def login(
    login_data: LoginRequest,
    db: AsyncSession = Depends(get_async_db)
):
    try:
        stmt = (
            select(Usuario)
            .options(
                selectinload(Usuario.roles),
                selectinload(Usuario.departamentos),
            )
            .where(
                and_(
                    Usuario.email == login_data.email.lower(),
                    Usuario.activo == True
                )
            )
        )

        result = await db.execute(stmt)
        user = result.scalar_one_or_none()

        if not user or not verify_password(login_data.password, user.password_hash):
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Credenciales incorrectas",
                headers={"WWW-Authenticate": "Bearer"},
            )

        user.ultimo_login = datetime.now(timezone.utc)
        await db.commit()

        access_token = create_access_token(data={"sub": str(user.id)})
        refresh_token = create_refresh_token(user.id)

        user_response = UsuarioResponse.model_validate(user)
        logger.info(f"Usuario {user.email} autenticado correctamente")

        return LoginResponse(
            access_token=access_token,
            refresh_token=refresh_token,
            expires_in=settings.access_token_expire_minutes * 60,
            user=user_response
        )

    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Error en login: {str(e)}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error interno del servidor"
        )


@auth_router.post("/refresh", response_model=TokenRefreshResponse)
async def refresh_token(
    payload: RefreshTokenRequest,
    db: AsyncSession = Depends(get_async_db)
):
    try:
        user_id = get_user_id_from_refresh_token(payload.refresh_token)

        result = await db.execute(
            select(Usuario).where(Usuario.id == user_id, Usuario.activo == True)
        )
        user = result.scalar_one_or_none()
        if not user:
            raise HTTPException(status_code=status.HTTP_401_UNAUTHORIZED, detail="Usuario inv√°lido")

        new_access = create_access_token(data={"sub": str(user.id)})
        return TokenRefreshResponse(
            access_token=new_access,
            expires_in=settings.access_token_expire_minutes * 60,
        )
    except JWTError:
        raise HTTPException(status_code=status.HTTP_401_UNAUTHORIZED, detail="Refresh token inv√°lido o expirado")
    except Exception as e:
        logger.error(f"Error en refresh: {str(e)}")
        raise HTTPException(status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, detail="Error interno del servidor")


@auth_router.get("/me", response_model=UsuarioResponse)
async def get_current_user_info(
    current_user: Usuario = Depends(get_current_active_user)
):
    return UsuarioResponse.model_validate(current_user)


@auth_router.put("/me", response_model=UsuarioResponse)
async def update_current_user(
    user_update: UsuarioUpdate,
    current_user: Usuario = Depends(get_current_active_user),
    db: AsyncSession = Depends(get_async_db)
):
    try:
        update_data = user_update.model_dump(exclude_unset=True)

        for field, value in update_data.items():
            if field == "email":
                stmt = select(Usuario).where(
                    and_(Usuario.email == value.lower(), Usuario.id != current_user.id)
                )
                result = await db.execute(stmt)
                if result.scalar_one_or_none():
                    raise HTTPException(
                        status_code=status.HTTP_400_BAD_REQUEST,
                        detail="El email ya est√° en uso"
                    )
                setattr(current_user, field, value.lower())
            else:
                setattr(current_user, field, value)

        await db.commit()
        await db.refresh(current_user)

        logger.info(f"Usuario {current_user.email} actualizado")
        return UsuarioResponse.model_validate(current_user)

    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Error al actualizar usuario: {str(e)}")
        await db.rollback()
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error al actualizar usuario"
        )


@auth_router.post("/change-password", response_model=MessageResponse)
async def change_password(
    password_data: ChangePasswordRequest,
    current_user: Usuario = Depends(get_current_active_user),
    db: AsyncSession = Depends(get_async_db)
):
    try:
        if not verify_password(password_data.current_password, current_user.password_hash):
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Contrase√±a actual incorrecta"
            )

        if password_data.new_password != password_data.confirm_password:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Las contrase√±as nuevas no coinciden"
            )

        current_user.password_hash = get_password_hash(password_data.new_password)
        await db.commit()

        logger.info(f"Contrase√±a cambiada para usuario {current_user.email}")
        return MessageResponse(message="Contrase√±a actualizada correctamente")

    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Error al cambiar contrase√±a: {str(e)}")
        await db.rollback()
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error al cambiar contrase√±a"
        )


# ============================================
# GESTI√ìN DE USUARIOS (Solo Admins)
# ============================================

@auth_router.post("/users", response_model=UsuarioResponse)
async def create_user(
    user_data: UsuarioCreate,
    db: AsyncSession = Depends(get_async_db),
    current_user: Usuario = Depends(require_roles("Super Admin", "Admin"))
):
    try:
        if user_data.password != user_data.confirm_password:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Las contrase√±as no coinciden"
            )

        stmt = select(Usuario).where(Usuario.email == user_data.email.lower())
        result = await db.execute(stmt)
        if result.scalar_one_or_none():
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="El email ya est√° registrado"
            )

        new_user = Usuario(
            email=user_data.email.lower(),
            password_hash=get_password_hash(user_data.password),
            nombre=user_data.nombre,
            apellido=user_data.apellido,
            telefono=user_data.telefono
        )
        db.add(new_user)
        await db.flush()

        # Asignar roles
        for role_id in (user_data.roles or []):
            role = (await db.execute(select(Rol).where(and_(Rol.id == role_id, Rol.activo == True)))).scalar_one_or_none()
            if role:
                db.add(UsuarioRol(usuario_id=new_user.id, rol_id=role_id, asignado_por=current_user.id))

        await db.commit()
        await db.refresh(new_user)

        new_user = (await db.execute(
            select(Usuario)
            .options(selectinload(Usuario.roles), selectinload(Usuario.departamentos))
            .where(Usuario.id == new_user.id))
        ).scalar_one()

        logger.info(f"Usuario creado: {new_user.email} por {current_user.email}")
        return UsuarioResponse.model_validate(new_user)

    except HTTPException:
        raise
    except Exception as e:
        logger.error(f"Error al crear usuario: {str(e)}")
        await db.rollback()
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error al crear usuario"
        )


@auth_router.get("/users", response_model=List[UsuarioResponse])
async def list_users(
    pagination: Pagination = Depends(get_pagination),
    db: AsyncSession = Depends(get_async_db),
    current_user: Usuario = Depends(require_roles("Super Admin", "Admin"))
):
    try:
        stmt = (
            select(Usuario)
            .options(selectinload(Usuario.roles), selectinload(Usuario.departamentos))
            .offset(pagination.offset).limit(pagination.per_page)
        )
        result = await db.execute(stmt)
        users = result.scalars().all()
        return [UsuarioResponse.model_validate(user) for user in users]

    except Exception as e:
        logger.error(f"Error al listar usuarios: {str(e)}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error al obtener usuarios"
        )


# ============================================
# GESTI√ìN DE ROLES
# ============================================

@auth_router.get("/roles", response_model=List[RolResponse])
async def list_roles(
    db: AsyncSession = Depends(get_async_db),
    current_user: Usuario = Depends(get_current_active_user)
):
    try:
        roles = (await db.execute(select(Rol).where(Rol.activo == True))).scalars().all()
        return [RolResponse.model_validate(role) for role in roles]
    except Exception as e:
        logger.error(f"Error al listar roles: {str(e)}")
        raise HTTPException(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            detail="Error al obtener roles"
        )


---
api\app\auth\schemas.py

"""
Schemas Pydantic para autenticaci√≥n y validaci√≥n
"""
from pydantic import BaseModel, EmailStr, Field
from typing import Optional, List
from datetime import datetime
import uuid


# ============================================
# SCHEMAS DE AUTENTICACI√ìN
# ============================================

class LoginRequest(BaseModel):
    """Schema para login"""
    email: EmailStr
    password: str = Field(..., min_length=6, description="Contrase√±a m√≠nimo 6 caracteres")


class LoginResponse(BaseModel):
    """Schema de respuesta de login"""
    access_token: str
    refresh_token: str
    token_type: str = "bearer"
    expires_in: int
    user: "UsuarioResponse"


class RefreshTokenRequest(BaseModel):
    """Schema para refresh token"""
    refresh_token: str


class ChangePasswordRequest(BaseModel):
    """Schema para cambio de contrase√±a"""
    current_password: str
    new_password: str = Field(..., min_length=6)
    confirm_password: str


# ============================================
# SCHEMAS DE USUARIO
# ============================================

class UsuarioBase(BaseModel):
    """Schema base de usuario"""
    email: EmailStr
    nombre: str = Field(..., min_length=2, max_length=100)
    apellido: str = Field(..., min_length=2, max_length=100)
    telefono: Optional[str] = Field(None, max_length=20)


class UsuarioCreate(UsuarioBase):
    """Schema para crear usuario"""
    password: str = Field(..., min_length=6, description="Contrase√±a m√≠nimo 6 caracteres")
    confirm_password: str
    roles: Optional[List[int]] = Field(default=[], description="IDs de roles")
    departamentos: Optional[List[int]] = Field(default=[], description="IDs de departamentos")

    class Config:
        json_schema_extra = {
            "example": {
                "email": "usuario@empresa.com",
                "nombre": "Juan",
                "apellido": "P√©rez",
                "telefono": "+52 55 1234-5678",
                "password": "password123",
                "confirm_password": "password123",
                "roles": [3],  # ID del rol "Colaborador"
                "departamentos": [2]  # ID del departamento
            }
        }


class UsuarioUpdate(BaseModel):
    """Schema para actualizar usuario"""
    email: Optional[EmailStr] = None
    nombre: Optional[str] = Field(None, min_length=2, max_length=100)
    apellido: Optional[str] = Field(None, min_length=2, max_length=100)
    telefono: Optional[str] = Field(None, max_length=20)
    activo: Optional[bool] = None


class UsuarioResponse(BaseModel):
    """Schema de respuesta de usuario"""
    id: int
    uuid: uuid.UUID
    email: str
    nombre: str
    apellido: str
    nombre_completo: str
    telefono: Optional[str]
    activo: bool
    ultimo_login: Optional[datetime]
    created_at: datetime
    roles: List["RolResponse"] = []
    departamentos: List["DepartamentoSimple"] = []

    class Config:
        from_attributes = True


# ============================================
# SCHEMAS DE ROL
# ============================================

class RolBase(BaseModel):
    """Schema base de rol"""
    nombre: str = Field(..., min_length=2, max_length=50)
    descripcion: Optional[str] = None


class RolCreate(RolBase):
    """Schema para crear rol"""
    pass


class RolUpdate(BaseModel):
    """Schema para actualizar rol"""
    nombre: Optional[str] = Field(None, min_length=2, max_length=50)
    descripcion: Optional[str] = None
    activo: Optional[bool] = None


class RolResponse(BaseModel):
    """Schema de respuesta de rol"""
    id: int
    nombre: str
    descripcion: Optional[str]
    activo: bool
    created_at: datetime

    class Config:
        from_attributes = True


# ============================================
# SCHEMAS DE ORGANIZACI√ìN
# ============================================

class OrganizacionBase(BaseModel):
    """Schema base de organizaci√≥n"""
    nombre: str = Field(..., min_length=2, max_length=255)
    razon_social: Optional[str] = Field(None, max_length=255)
    rfc: Optional[str] = Field(None, max_length=20)
    telefono: Optional[str] = Field(None, max_length=20)
    email: Optional[EmailStr] = None
    direccion: Optional[str] = None
    ciudad: Optional[str] = Field(None, max_length=100)
    estado: Optional[str] = Field(None, max_length=100)
    codigo_postal: Optional[str] = Field(None, max_length=10)
    pais: str = Field(default="Argentina", max_length=100)


class OrganizacionCreate(OrganizacionBase):
    """Schema para crear organizaci√≥n"""
    pass


class OrganizacionUpdate(BaseModel):
    """Schema para actualizar organizaci√≥n"""
    nombre: Optional[str] = Field(None, min_length=2, max_length=255)
    razon_social: Optional[str] = Field(None, max_length=255)
    rfc: Optional[str] = Field(None, max_length=20)
    telefono: Optional[str] = Field(None, max_length=20)
    email: Optional[EmailStr] = None
    direccion: Optional[str] = None
    ciudad: Optional[str] = Field(None, max_length=100)
    estado: Optional[str] = Field(None, max_length=100)
    codigo_postal: Optional[str] = Field(None, max_length=10)
    pais: Optional[str] = Field(None, max_length=100)
    activa: Optional[bool] = None


class OrganizacionResponse(BaseModel):
    """Schema de respuesta de organizaci√≥n"""
    id: int
    uuid: uuid.UUID
    nombre: str
    razon_social: Optional[str]
    rfc: Optional[str]
    telefono: Optional[str]
    email: Optional[str]
    direccion: Optional[str]
    ciudad: Optional[str]
    estado: Optional[str]
    codigo_postal: Optional[str]
    pais: str
    activa: bool
    created_at: datetime

    class Config:
        from_attributes = True


# ============================================
# SCHEMAS DE DEPARTAMENTO
# ============================================

class DepartamentoBase(BaseModel):
    """Schema base de departamento"""
    nombre: str = Field(..., min_length=2, max_length=100)
    descripcion: Optional[str] = None


class DepartamentoCreate(DepartamentoBase):
    """Schema para crear departamento"""
    organizacion_id: int
    departamento_padre_id: Optional[int] = None
    responsable_id: Optional[int] = None


class DepartamentoUpdate(BaseModel):
    """Schema para actualizar departamento"""
    nombre: Optional[str] = Field(None, min_length=2, max_length=100)
    descripcion: Optional[str] = None
    responsable_id: Optional[int] = None
    activo: Optional[bool] = None


class DepartamentoSimple(BaseModel):
    """Schema simple de departamento"""
    id: int
    nombre: str
    descripcion: Optional[str]

    class Config:
        from_attributes = True


class DepartamentoResponse(BaseModel):
    """Schema de respuesta de departamento"""
    id: int
    uuid: uuid.UUID
    nombre: str
    descripcion: Optional[str]
    organizacion_id: int
    departamento_padre_id: Optional[int]
    responsable_id: Optional[int]
    activo: bool
    created_at: datetime
    responsable: Optional["UsuarioResponse"] = None

    class Config:
        from_attributes = True


# ============================================
# SCHEMAS GENERALES
# ============================================

class MessageResponse(BaseModel):
    """Schema para respuestas de mensaje"""
    message: str
    success: bool = True


class ErrorResponse(BaseModel):
    """Schema para respuestas de error"""
    detail: str
    error_code: Optional[str] = None
    success: bool = False


class PaginatedResponse(BaseModel):
    """Schema para respuestas paginadas"""
    items: List[BaseModel]
    total: int
    page: int = 1
    per_page: int = 50
    pages: int
    has_next: bool
    has_prev: bool


# ============================================
# CONFIGURAR FORWARD REFERENCES
# ============================================
# ... imports y clases previas ...

class TokenRefreshResponse(BaseModel):
    access_token: str
    token_type: str = "bearer"
    expires_in: int


# Actualizar forward references
UsuarioResponse.model_rebuild()
LoginResponse.model_rebuild()
DepartamentoResponse.model_rebuild()


---
api\app\auth\__init__.py



---
api\app\projects\models.py

from sqlalchemy import Column, Integer, String, Text, Boolean, Date, DateTime, Numeric, ForeignKey
from sqlalchemy.dialects.postgresql import UUID
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
from ..database import Base
import uuid

class Proyecto(Base):
    __tablename__ = "proyectos"

    id = Column(Integer, primary_key=True, index=True)
    uuid = Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, index=True)
    codigo = Column(String, unique=True)
    nombre = Column(String, nullable=False)
    descripcion = Column(Text)
    organizacion_id = Column(Integer, ForeignKey("organizaciones.id", ondelete="SET NULL"))
    gerente_proyecto_id = Column(Integer, ForeignKey("usuarios.id", ondelete="SET NULL"))
    sponsor_id = Column(Integer, ForeignKey("usuarios.id", ondelete="SET NULL"))
    prioridad = Column(Integer, default=3)
    estado = Column(String, default="EN_PROGRESO")
    presupuesto_monto = Column(Numeric(14, 2), default=0)
    avance_pct = Column(Numeric(5, 2), default=0)
    fecha_inicio = Column(Date)
    fecha_fin_plan = Column(Date)
    fecha_fin_real = Column(Date)
    activo = Column(Boolean, default=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    tareas = relationship("Tarea", back_populates="proyecto")

    def __repr__(self):
        return f"<Proyecto(id={self.id}, nombre='{self.nombre}')>"

class Tarea(Base):
    __tablename__ = "tareas"

    id = Column(Integer, primary_key=True, index=True)
    uuid = Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, index=True)
    proyecto_id = Column(Integer, ForeignKey("proyectos.id", ondelete="CASCADE"), nullable=False)
    titulo = Column(String, nullable=False)
    descripcion = Column(Text)
    estado = Column(String, default="PENDIENTE")
    prioridad = Column(Integer, default=3)
    asignado_a = Column(Integer, ForeignKey("usuarios.id", ondelete="SET NULL"))
    estimado_horas = Column(Numeric(10, 2), default=0)
    real_horas = Column(Numeric(10, 2), default=0)
    fecha_inicio = Column(Date)
    fecha_fin_plan = Column(Date)
    fecha_fin_real = Column(Date)
    activo = Column(Boolean, default=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
    deleted_at = Column(DateTime(timezone=True))

    proyecto = relationship("Proyecto", back_populates="tareas")

    def __repr__(self):
        return f"<Tarea(id={self.id}, titulo='{self.titulo}')>"


---
api\app\projects\routes.py

# api/app/projects/routes.py
from fastapi import APIRouter, Depends, HTTPException, status, Response
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, text
from typing import Optional, List
from pydantic import BaseModel, EmailStr

from ..database import get_async_db
from ..utils.dependencies import get_current_active_user, require_permissions
from .models import Proyecto, Tarea
from .schemas import (
    ProyectoCreate, ProyectoUpdate, ProyectoResponse,
    TareaCreate, TareaUpdate, TareaResponse, ResumenEstadoItem
)

# IMPORTANTE: mantenemos este nombre porque main.py hace `from .projects import router`
router = APIRouter()

# --------------------------- Helpers de membres√≠a/seguridad ---------------------------

async def _is_admin(db: AsyncSession, user_id: int) -> bool:
    q = text("""
        SELECT 1
        FROM usuario_roles ur
        JOIN roles r ON r.id = ur.rol_id
        WHERE ur.usuario_id = :uid AND r.nombre IN ('Super Admin','Admin')
        LIMIT 1
    """)
    return (await db.execute(q, {"uid": user_id})).scalar() is not None

async def _project_exists(db: AsyncSession, project_id: int) -> bool:
    q = text("SELECT 1 FROM proyectos WHERE id = :pid AND deleted_at IS NULL")
    return (await db.execute(q, {"pid": project_id})).scalar() is not None

async def _is_member(db: AsyncSession, project_id: int, user_id: int) -> bool:
    q = text("SELECT 1 FROM proyecto_miembros WHERE proyecto_id = :pid AND usuario_id = :uid")
    return (await db.execute(q, {"pid": project_id, "uid": user_id})).scalar() is not None

# --------------------------- Proyectos ---------------------------

@router.post("", response_model=ProyectoResponse)
async def create_project(
    data: ProyectoCreate,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:projects"))
):
    p = Proyecto(
        codigo=data.codigo,
        nombre=data.nombre,
        descripcion=data.descripcion,
        prioridad=data.prioridad or 3
    )
    db.add(p)
    await db.flush()
    await db.commit()
    await db.refresh(p)
    return ProyectoResponse.model_validate(p)

@router.get("", response_model=list[ProyectoResponse], summary="Listar proyectos visibles")
async def list_projects(
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("read:projects"))
):
    # Admin ve todos; colaborador solo los que es miembro
    if await _is_admin(db, user.id):
        result = await db.execute(select(Proyecto).where(Proyecto.deleted_at.is_(None)))
        items = result.scalars().all()
        return [ProyectoResponse.model_validate(i) for i in items]
    else:
        q = text("""
            SELECT id, uuid, codigo, nombre, estado, prioridad, avance_pct, presupuesto_monto
            FROM proyectos p
            WHERE p.deleted_at IS NULL
              AND EXISTS (SELECT 1 FROM proyecto_miembros pm
                          WHERE pm.proyecto_id = p.id AND pm.usuario_id = :uid)
            ORDER BY id
        """)
        rows = (await db.execute(q, {"uid": user.id})).mappings().all()
        return [ProyectoResponse(**dict(r)) for r in rows]

@router.get("/{project_id}", response_model=ProyectoResponse, summary="Obtener proyecto si hay acceso")
async def get_project(
    project_id: int,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("read:projects"))
):
    if not await _project_exists(db, project_id):
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")

    if not (await _is_admin(db, user.id) or await _is_member(db, project_id, user.id)):
        raise HTTPException(status_code=403, detail="Sin acceso a este proyecto")

    result = await db.execute(select(Proyecto).where(Proyecto.id == project_id, Proyecto.deleted_at.is_(None)))
    p = result.scalar_one_or_none()
    if not p:
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")
    return ProyectoResponse.model_validate(p)

@router.patch("/{project_id}", response_model=ProyectoResponse)
async def update_project(
    project_id: int,
    data: ProyectoUpdate,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:projects"))
):
    result = await db.execute(select(Proyecto).where(Proyecto.id == project_id, Proyecto.deleted_at.is_(None)))
    p = result.scalar_one_or_none()
    if not p:
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")
    for k, v in data.model_dump(exclude_unset=True).items():
        setattr(p, k, v)
    await db.commit()
    await db.refresh(p)
    return ProyectoResponse.model_validate(p)

# --------------------------- Tareas ---------------------------

@router.post("/tasks", response_model=TareaResponse)
async def create_task(
    data: TareaCreate,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:tasks"))
):
    # validar proyecto
    result = await db.execute(select(Proyecto.id).where(Proyecto.id == data.proyecto_id, Proyecto.deleted_at.is_(None)))
    if not result.scalar_one_or_none():
        raise HTTPException(status_code=404, detail="Proyecto no existe")
    t = Tarea(
        proyecto_id=data.proyecto_id,
        titulo=data.titulo,
        descripcion=data.descripcion,
        prioridad=data.prioridad or 3
    )
    db.add(t)
    await db.flush()
    await db.commit()
    await db.refresh(t)
    return TareaResponse.model_validate(t)

@router.get("/{project_id}/tasks", response_model=list[TareaResponse])
async def list_tasks(
    project_id: int,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("read:tasks"))
):
    # Nota: si quieres, puedes aplicar el mismo control de acceso que en get_project
    result = await db.execute(select(Tarea).where(Tarea.proyecto_id == project_id, Tarea.deleted_at.is_(None)))
    items = result.scalars().all()
    return [TareaResponse.model_validate(i) for i in items]

@router.patch("/tasks/{task_id}", response_model=TareaResponse)
async def update_task(
    task_id: int,
    data: TareaUpdate,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:tasks"))
):
    result = await db.execute(select(Tarea).where(Tarea.id == task_id, Tarea.deleted_at.is_(None)))
    t = result.scalar_one_or_none()
    if not t:
        raise HTTPException(status_code=404, detail="Tarea no encontrada")
    for k, v in data.model_dump(exclude_unset=True).items():
        setattr(t, k, v)
    await db.commit()
    await db.refresh(t)
    return TareaResponse.model_validate(t)

# --------------------------- Reporte simple (vista) ---------------------------

@router.get("/{project_id}/report/estado", response_model=list[ResumenEstadoItem])
async def resumen_por_estado(
    project_id: int,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("read:reports"))
):
    q = text("""
        SELECT proyecto_id, proyecto, estado, cantidad
        FROM vw_resumen_tareas_por_estado
        WHERE proyecto_id = :pid
        ORDER BY estado
    """)
    result = await db.execute(q, {"pid": project_id})
    rows = result.mappings().all()
    return [ResumenEstadoItem(**dict(r)) for r in rows]

# --------------------------- Miembros del proyecto ---------------------------

class MemberCreate(BaseModel):
    usuario_id: Optional[int] = None
    email: Optional[EmailStr] = None

class MemberOut(BaseModel):
    id: int
    email: EmailStr
    nombre: Optional[str] = None
    apellido: Optional[str] = None
    rol_en_proyecto: str = "MIEMBRO"

@router.get("/{project_id}/members", response_model=List[MemberOut], summary="Listar miembros")
async def list_members(
    project_id: int,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("read:projects"))
):
    if not await _project_exists(db, project_id):
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")
    if not (await _is_admin(db, user.id) or await _is_member(db, project_id, user.id)):
        raise HTTPException(status_code=403, detail="Sin acceso a este proyecto")

    q = text("""
        SELECT u.id, u.email, u.nombre, u.apellido, pm.rol_en_proyecto
        FROM proyecto_miembros pm
        JOIN usuarios u ON u.id = pm.usuario_id
        WHERE pm.proyecto_id = :pid
        ORDER BY u.nombre, u.apellido, u.email
    """)
    rows = (await db.execute(q, {"pid": project_id})).mappings().all()
    return [MemberOut(**dict(r)) for r in rows]

@router.post("/{project_id}/members", response_model=MemberOut, status_code=201, summary="Agregar miembro (solo Admin)")
async def add_member(
    project_id: int,
    payload: MemberCreate,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:projects"))
):
    if not await _project_exists(db, project_id):
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")
    if not await _is_admin(db, user.id):
        raise HTTPException(status_code=403, detail="Solo Admin puede agregar miembros")

    usuario_id = payload.usuario_id
    if not usuario_id and payload.email:
        uid = (await db.execute(text("SELECT id FROM usuarios WHERE email=:em"), {"em": payload.email})).scalar()
        if not uid:
            raise HTTPException(status_code=404, detail="Usuario no encontrado")
        usuario_id = uid
    if not usuario_id:
        raise HTTPException(status_code=422, detail="Debes enviar usuario_id o email")

    await db.execute(text("""
        INSERT INTO proyecto_miembros (proyecto_id, usuario_id)
        VALUES (:pid, :uid)
        ON CONFLICT (proyecto_id, usuario_id) DO NOTHING
    """), {"pid": project_id, "uid": usuario_id})
    await db.commit()

    q = text("""
        SELECT u.id, u.email, u.nombre, u.apellido, pm.rol_en_proyecto
        FROM proyecto_miembros pm
        JOIN usuarios u ON u.id = pm.usuario_id
        WHERE pm.proyecto_id = :pid AND pm.usuario_id = :uid
    """)
    row = (await db.execute(q, {"pid": project_id, "uid": usuario_id})).mappings().first()
    return MemberOut(**dict(row))

@router.delete("/{project_id}/members/{usuario_id}", status_code=204, summary="Quitar miembro (solo Admin)")
async def remove_member(
    project_id: int,
    usuario_id: int,
    db: AsyncSession = Depends(get_async_db),
    user = Depends(require_permissions("write:projects"))
):
    if not await _project_exists(db, project_id):
        raise HTTPException(status_code=404, detail="Proyecto no encontrado")
    if not await _is_admin(db, user.id):
        raise HTTPException(status_code=403, detail="Solo Admin puede quitar miembros")

    res = await db.execute(text("""
        DELETE FROM proyecto_miembros
        WHERE proyecto_id = :pid AND usuario_id = :uid
    """), {"pid": project_id, "uid": usuario_id})
    if res.rowcount == 0:
        raise HTTPException(status_code=404, detail="Membres√≠a no encontrada")
    await db.commit()
    return Response(status_code=204)


---
api\app\projects\schemas.py

# api/app/projects/schemas.py
from pydantic import BaseModel, Field
from typing import Optional, Dict, List
from datetime import date
import uuid

class ProyectoCreate(BaseModel):
    codigo: Optional[str] = None
    nombre: str = Field(..., min_length=2)
    descripcion: Optional[str] = None
    prioridad: Optional[int] = 3

class ProyectoUpdate(BaseModel):
    nombre: Optional[str] = None
    descripcion: Optional[str] = None
    prioridad: Optional[int] = None
    estado: Optional[str] = None
    presupuesto_monto: Optional[float] = None
    avance_pct: Optional[float] = None
    fecha_inicio: Optional[date] = None
    fecha_fin_plan: Optional[date] = None
    fecha_fin_real: Optional[date] = None

class ProyectoResponse(BaseModel):
    id: int
    uuid: uuid.UUID
    codigo: Optional[str]
    nombre: str
    estado: str
    prioridad: int
    avance_pct: float | None
    presupuesto_monto: float | None
    class Config:
        from_attributes = True

class TareaCreate(BaseModel):
    proyecto_id: int
    titulo: str
    descripcion: Optional[str] = None
    prioridad: Optional[int] = 3

class TareaUpdate(BaseModel):
    titulo: Optional[str] = None
    descripcion: Optional[str] = None
    prioridad: Optional[int] = None
    estado: Optional[str] = None
    real_horas: Optional[float] = None
    fecha_fin_real: Optional[date] = None

class TareaResponse(BaseModel):
    id: int
    uuid: uuid.UUID
    proyecto_id: int
    titulo: str
    estado: str
    prioridad: int
    real_horas: float | None
    class Config:
        from_attributes = True

class ResumenEstadoItem(BaseModel):
    proyecto_id: int
    proyecto: str
    estado: str
    cantidad: int

# ==== Opcionales de conveniencia ====

class ProyectoSummary(BaseModel):
    proyecto: ProyectoResponse
    total_tareas: int
    por_estado: Dict[str, int]
    tareas: List[TareaResponse]

class ProyectoStateUpdate(BaseModel):
    estado: Optional[str] = None


---
api\app\projects\__init__.py

# Exponer router y modelos del m√≥dulo projects
from .routes import router
from .models import Proyecto, Tarea

__all__ = ["router", "Proyecto", "Tarea"]


---
api\app\utils\dependencies.py

# api/app/utils/dependencies.py
from typing import Optional, Callable
import logging
from fastapi import Depends, HTTPException, status
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy.orm import selectinload
from sqlalchemy import select

from ..database import get_async_db
from ..auth.models import Usuario
from ..utils.security import get_user_id_from_token

logger = logging.getLogger(__name__)

security = HTTPBearer(auto_error=True)
optional_security = HTTPBearer(auto_error=False)


async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Depends(security),
    db: AsyncSession = Depends(get_async_db),
) -> Usuario:
    """
    Devuelve el usuario autenticado a partir del token.
    """
    try:
        user_id = get_user_id_from_token(credentials.credentials)

        stmt = (
            select(Usuario)
            .options(
                selectinload(Usuario.roles),
                selectinload(Usuario.departamentos),
            )
            .where(Usuario.id == user_id, Usuario.activo == True)
        )

        result = await db.execute(stmt)
        user = result.scalar_one_or_none()
        if user is None:
            raise HTTPException(
                status_code=status.HTTP_404_NOT_FOUND,
                detail="Usuario no encontrado o inactivo",
            )
        return user
    except HTTPException:
        raise
    except Exception as e:
        logger.exception("Error obteniendo usuario actual: %s", e)
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED, detail="Credenciales inv√°lidas"
        ) from e


async def get_current_active_user(
    current_user: Usuario = Depends(get_current_user),
) -> Usuario:
    if not current_user.activo:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN, detail="Usuario inactivo"
        )
    return current_user


def require_roles(*required_roles: str) -> Callable[..., Usuario]:
    """
    Dependencia para exigir uno de los roles indicados.
    """
    async def checker(
        current_user: Usuario = Depends(get_current_active_user),
    ) -> Usuario:
        user_roles = [r.nombre for r in current_user.roles if r and r.activo]
        if not any(role in user_roles for role in required_roles):
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail=f"Se requiere uno de los roles: {', '.join(required_roles)}",
            )
        return current_user

    return checker


def require_permissions(*permissions: str) -> Callable[..., Usuario]:
    """
    Dependencia sencilla basada en roles -> permisos.
    """
    perm_map = {
        "read:users": ["Admin", "Gerente de Proyecto", "L√≠der de Equipo"],
        "write:users": ["Super Admin", "Admin"],
        "read:projects": ["Admin", "Gerente de Proyecto", "L√≠der de Equipo", "Colaborador"],
        "write:projects": ["Admin", "Gerente de Proyecto"],
        "read:tasks": ["Admin", "Gerente de Proyecto", "L√≠der de Equipo", "Colaborador"],
        "write:tasks": ["Admin", "Gerente de Proyecto", "L√≠der de Equipo"],
        "read:reports": ["Admin", "Gerente de Proyecto"],
        "write:reports": ["Admin", "Gerente de Proyecto"],
    }

    async def checker(
        current_user: Usuario = Depends(get_current_active_user),
    ) -> Usuario:
        user_roles = [r.nombre for r in current_user.roles if r and r.activo]
        if "Super Admin" in user_roles:
            return current_user

        for p in permissions:
            allowed = perm_map.get(p, [])
            if not any(r in user_roles for r in allowed):
                raise HTTPException(
                    status_code=status.HTTP_403_FORBIDDEN,
                    detail=f"Permisos insuficientes. Falta: {p}",
                )
        return current_user

    return checker


async def get_optional_user(
    credentials: Optional[HTTPAuthorizationCredentials] = Depends(optional_security),
    db: AsyncSession = Depends(get_async_db),
) -> Optional[Usuario]:
    """
    Devuelve el usuario si trae token; si no, None.
    """
    if not credentials:
        return None
    try:
        return await get_current_user(credentials, db)
    except Exception:
        return None


class Pagination:
    """
    Paginaci√≥n simple: limita per_page a [1..100]
    """
    def __init__(self, page: int = 1, per_page: int = 50):
        self.page = max(1, page)
        self.per_page = min(max(1, per_page), 100)
        self.offset = (self.page - 1) * self.per_page

    def params(self) -> dict:
        return {"limit": self.per_page, "offset": self.offset}


def get_pagination(page: int = 1, per_page: int = 50) -> Pagination:
    """
    Dependencia que devuelve un objeto Pagination.
    """
    return Pagination(page, per_page)


---
api\app\utils\security.py

# api/app/utils/security.py
from datetime import datetime, timedelta, timezone
from typing import Any, Optional, Dict

from jose import jwt, JWTError
from passlib.context import CryptContext

from ..config import settings

# BCrypt para hash/verify
pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")


def get_password_hash(password: str) -> str:
    return pwd_context.hash(password)


def verify_password(plain_password: str, password_hash: str) -> bool:
    try:
        return pwd_context.verify(plain_password, password_hash)
    except Exception:
        return False


def _jwt_encode(claims: Dict[str, Any]) -> str:
    return jwt.encode(claims, settings.secret_key, algorithm=settings.algorithm)


def _jwt_decode(token: str) -> Dict[str, Any]:
    return jwt.decode(token, settings.secret_key, algorithms=[settings.algorithm])


def create_access_token(data: Dict[str, Any], expires_minutes: Optional[int] = None) -> str:
    to_encode = data.copy()
    exp_minutes = expires_minutes if expires_minutes is not None else settings.access_token_expire_minutes
    expire = datetime.now(timezone.utc) + timedelta(minutes=int(exp_minutes))
    if "sub" in to_encode:
        to_encode["sub"] = str(to_encode["sub"])
    to_encode.update({"exp": expire, "type": "access"})
    return _jwt_encode(to_encode)


def create_refresh_token(user_id: int, days: int = 30) -> str:
    expire = datetime.now(timezone.utc) + timedelta(days=days)
    to_encode = {"sub": str(user_id), "exp": expire, "type": "refresh"}
    return _jwt_encode(to_encode)


def get_user_id_from_token(token: str) -> int:
    try:
        payload = _jwt_decode(token)
        sub = payload.get("sub")
        if sub is None:
            raise JWTError("Token sin 'sub'")
        return int(sub)
    except Exception as e:
        raise JWTError(f"Token inv√°lido: {e}") from e

# api/app/utils/security.py (secci√≥n final ‚Äúrefresh‚Äù)
from jose import JWTError

def get_user_id_from_refresh_token(token: str) -> int:
    try:
        payload = _jwt_decode(token)
        if payload.get("type") != "refresh":
            raise JWTError("Token no es de tipo refresh")
        sub = payload.get("sub")
        if not sub:
            raise JWTError("Refresh token sin 'sub'")
        return int(sub)
    except JWTError:
        raise
    except Exception as e:
        raise JWTError(f"Refresh inv√°lido: {e}") from e


---
api\app\utils\__init__.py



---
init-scripts\01-schema.sql

CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- ===== Usuarios / Roles =====
CREATE TABLE IF NOT EXISTS usuarios (
  id             SERIAL PRIMARY KEY,
  uuid           UUID NOT NULL DEFAULT gen_random_uuid(),
  email          TEXT NOT NULL UNIQUE,
  password_hash  TEXT NOT NULL,
  nombre         TEXT NOT NULL,
  apellido       TEXT NOT NULL,
  telefono       TEXT,
  activo         BOOLEAN NOT NULL DEFAULT TRUE,
  ultimo_login   TIMESTAMPTZ,
  created_at     TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at     TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at     TIMESTAMPTZ
);

CREATE TABLE IF NOT EXISTS roles (
  id          SERIAL PRIMARY KEY,
  nombre      TEXT NOT NULL UNIQUE,
  descripcion TEXT,
  activo      BOOLEAN NOT NULL DEFAULT TRUE,
  created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at  TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at  TIMESTAMPTZ
);

CREATE TABLE IF NOT EXISTS usuario_roles (
  id           SERIAL PRIMARY KEY,
  usuario_id   INT NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
  rol_id       INT NOT NULL REFERENCES roles(id) ON DELETE CASCADE,
  asignado_por INT REFERENCES usuarios(id),
  created_at   TIMESTAMPTZ NOT NULL DEFAULT now()
);

-- garantizar que no se dupliquen asignaciones usuario-rol
CREATE UNIQUE INDEX IF NOT EXISTS uq_usuario_roles_usuario_rol
  ON usuario_roles(usuario_id, rol_id);

-- √çndices √∫tiles
CREATE INDEX IF NOT EXISTS idx_usuarios_email ON usuarios(email);
CREATE INDEX IF NOT EXISTS idx_usuarios_activo ON usuarios(activo) WHERE deleted_at IS NULL;
CREATE INDEX IF NOT EXISTS idx_usuario_roles_usuario ON usuario_roles(usuario_id);
CREATE INDEX IF NOT EXISTS idx_usuario_roles_rol ON usuario_roles(rol_id);

-- ===== Organizaci√≥n / Departamentos =====
CREATE TABLE IF NOT EXISTS organizaciones (
  id            SERIAL PRIMARY KEY,
  uuid          UUID NOT NULL DEFAULT gen_random_uuid(),
  nombre        TEXT NOT NULL,
  razon_social  TEXT,
  rfc           TEXT,
  telefono      TEXT,
  email         TEXT,
  direccion     TEXT,
  ciudad        TEXT,
  estado        TEXT,
  codigo_postal TEXT,
  pais          TEXT NOT NULL DEFAULT 'Argentina',
  activa        BOOLEAN NOT NULL DEFAULT TRUE,
  created_at    TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at    TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at    TIMESTAMPTZ
);

CREATE TABLE IF NOT EXISTS departamentos (
  id                     SERIAL PRIMARY KEY,
  uuid                   UUID NOT NULL DEFAULT gen_random_uuid(),
  nombre                 TEXT NOT NULL,
  descripcion            TEXT,
  organizacion_id        INT REFERENCES organizaciones(id) ON DELETE CASCADE,
  departamento_padre_id  INT REFERENCES departamentos(id),
  responsable_id         INT REFERENCES usuarios(id),
  activo                 BOOLEAN NOT NULL DEFAULT TRUE,
  created_at             TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at             TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at             TIMESTAMPTZ
);

CREATE TABLE IF NOT EXISTS usuario_departamentos (
  id               SERIAL PRIMARY KEY,
  usuario_id       INT REFERENCES usuarios(id) ON DELETE CASCADE,
  departamento_id  INT REFERENCES departamentos(id) ON DELETE CASCADE,
  es_responsable   BOOLEAN NOT NULL DEFAULT FALSE,
  created_at       TIMESTAMPTZ NOT NULL DEFAULT now()
);

-- √çndices parciales para soft delete
CREATE INDEX IF NOT EXISTS idx_orgs_activas ON organizaciones(id) WHERE deleted_at IS NULL;
CREATE INDEX IF NOT EXISTS idx_deptos_activos ON departamentos(id) WHERE deleted_at IS NULL;
CREATE INDEX IF NOT EXISTS idx_usuario_deptos_usuario ON usuario_departamentos(usuario_id);
CREATE INDEX IF NOT EXISTS idx_usuario_deptos_depto ON usuario_departamentos(departamento_id);


---
init-scripts\02-datos-iniciales.sql

-- init-scripts/02-datos-iniciales.sql
-- Este archivo se deja m√≠nimo para evitar duplicar DDL del 01.
CREATE EXTENSION IF NOT EXISTS pgcrypto;


---
init-scripts\03-schema-projects.sql

-- init-scripts/03-schema-projects.sql
CREATE EXTENSION IF NOT EXISTS pgcrypto;

CREATE TABLE IF NOT EXISTS proyectos (
  id                 SERIAL PRIMARY KEY,
  uuid               UUID NOT NULL DEFAULT gen_random_uuid(),
  codigo             TEXT UNIQUE,
  nombre             TEXT NOT NULL,
  descripcion        TEXT,
  organizacion_id    INT REFERENCES organizaciones(id) ON DELETE SET NULL,
  gerente_proyecto_id INT REFERENCES usuarios(id) ON DELETE SET NULL,
  sponsor_id         INT REFERENCES usuarios(id) ON DELETE SET NULL,
  prioridad          SMALLINT NOT NULL DEFAULT 3,
  estado             TEXT NOT NULL DEFAULT 'EN_PROGRESO',
  presupuesto_monto  NUMERIC(14,2) DEFAULT 0,
  avance_pct         NUMERIC(5,2)  DEFAULT 0,
  fecha_inicio       DATE,
  fecha_fin_plan     DATE,
  fecha_fin_real     DATE,
  activo             BOOLEAN NOT NULL DEFAULT TRUE,
  created_at         TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at         TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at         TIMESTAMPTZ
);

CREATE INDEX IF NOT EXISTS idx_proy_codigo ON proyectos(codigo) WHERE deleted_at IS NULL;
CREATE INDEX IF NOT EXISTS idx_proy_estado ON proyectos(estado) WHERE deleted_at IS NULL;

CREATE TABLE IF NOT EXISTS tareas (
  id              SERIAL PRIMARY KEY,
  uuid            UUID NOT NULL DEFAULT gen_random_uuid(),
  proyecto_id     INT NOT NULL REFERENCES proyectos(id) ON DELETE CASCADE,
  titulo          TEXT NOT NULL,
  descripcion     TEXT,
  estado          TEXT NOT NULL DEFAULT 'PENDIENTE',
  prioridad       SMALLINT NOT NULL DEFAULT 3,
  asignado_a      INT REFERENCES usuarios(id) ON DELETE SET NULL,
  estimado_horas  NUMERIC(10,2) DEFAULT 0,
  real_horas      NUMERIC(10,2) DEFAULT 0,
  fecha_inicio    DATE,
  fecha_fin_plan  DATE,
  fecha_fin_real  DATE,
  activo          BOOLEAN NOT NULL DEFAULT TRUE,
  created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
  deleted_at      TIMESTAMPTZ
);

CREATE INDEX IF NOT EXISTS idx_tareas_proyecto ON tareas(proyecto_id) WHERE deleted_at IS NULL;
CREATE INDEX IF NOT EXISTS idx_tareas_estado ON tareas(estado) WHERE deleted_at IS NULL;

CREATE OR REPLACE VIEW vw_resumen_tareas_por_estado AS
SELECT
  p.id AS proyecto_id,
  p.nombre AS proyecto,
  t.estado,
  COUNT(*)::int AS cantidad
FROM proyectos p
JOIN tareas t ON t.proyecto_id = p.id AND t.deleted_at IS NULL
WHERE p.deleted_at IS NULL
GROUP BY p.id, p.nombre, t.estado
ORDER BY p.id, t.estado;


---
init-scripts\04-data-demo.sql

-- init-scripts/04-data-demo.sql
WITH upsert AS (
  INSERT INTO proyectos (codigo, nombre, estado, prioridad, presupuesto_monto)
  VALUES ('DEMO-2024-001','Implementaci√≥n de Sistema ERP','EN_PROGRESO',2,500000)
  ON CONFLICT (codigo) DO NOTHING
  RETURNING id
)
INSERT INTO tareas (proyecto_id, titulo, estado, prioridad, estimado_horas)
SELECT COALESCE((SELECT id FROM upsert), (SELECT id FROM proyectos WHERE codigo='DEMO-2024-001' LIMIT 1)),
       t.titulo, t.estado, t.prioridad, t.est
FROM (VALUES
  ('An√°lisis de Requerimientos','HECHA',2,16),
  ('Dise√±o de Base de Datos','EN_PROGRESO',2,24),
  ('API de Autenticaci√≥n','EN_PROGRESO',2,20),
  ('Gesti√≥n de Proyectos (CRUD)','PENDIENTE',3,20),
  ('Reporte b√°sico','PENDIENTE',3,12)
) AS t(titulo, estado, prioridad, est);


---
init-scripts\05-initial-data.sql

-- init-scripts/05-initial-data.sql

-- Roles b√°sicos
INSERT INTO roles (nombre, descripcion) VALUES 
('Super Admin', 'Administrador del sistema con todos los permisos'),
('Admin', 'Administrador con permisos de gesti√≥n'),
('Gerente de Proyecto', 'Gestor de proyectos y equipos'),
('L√≠der de Equipo', 'L√≠der de equipos de trabajo'),
('Colaborador', 'Usuario colaborador b√°sico')
ON CONFLICT (nombre) DO NOTHING;

-- Usuario admin inicial (password: admin123) usando pgcrypto (bcrypt)
INSERT INTO usuarios (email, password_hash, nombre, apellido, activo)
VALUES ('admin@miempresa.com', crypt('admin123', gen_salt('bf')), 'Administrador', 'Sistema', TRUE)
ON CONFLICT (email) DO UPDATE
  SET password_hash = EXCLUDED.password_hash,
      nombre = EXCLUDED.nombre,
      apellido = EXCLUDED.apellido,
      activo = TRUE;

-- Asignar rol Super Admin al admin
INSERT INTO usuario_roles (usuario_id, rol_id, asignado_por)
SELECT u.id, r.id, u.id
FROM usuarios u
JOIN roles r ON r.nombre = 'Super Admin'
WHERE u.email = 'admin@miempresa.com'
ON CONFLICT (usuario_id, rol_id) DO NOTHING;

-- Organizaci√≥n y Departamento demo
INSERT INTO organizaciones (nombre, razon_social, pais)
VALUES ('Mi Empresa S.A.', 'Mi Empresa Sociedad An√≥nima', 'Argentina')
ON CONFLICT DO NOTHING;

INSERT INTO departamentos (nombre, descripcion, organizacion_id)
SELECT 'Sistemas', 'Departamento de Tecnolog√≠a', o.id
FROM organizaciones o
WHERE o.nombre = 'Mi Empresa S.A.'
ON CONFLICT DO NOTHING;


---
init-scripts\06-fix-admin.sql

-- init-scripts/06-fix-admin.sql
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- Roles base
INSERT INTO roles (nombre, descripcion) VALUES
('Super Admin','Administrador del sistema con todos los permisos'),
('Admin','Administrador con permisos de gesti√≥n'),
('Gerente de Proyecto','Gestor de proyectos y equipos'),
('L√≠der de Equipo','L√≠der de equipos de trabajo'),
('Colaborador','Usuario colaborador b√°sico')
ON CONFLICT (nombre) DO NOTHING;

-- Admin inicial
INSERT INTO usuarios (email, password_hash, nombre, apellido, activo)
VALUES ('admin@miempresa.com', crypt('admin123', gen_salt('bf')), 'Administrador', 'Sistema', TRUE)
ON CONFLICT (email) DO UPDATE
SET password_hash = EXCLUDED.password_hash,
    nombre = EXCLUDED.nombre,
    apellido = EXCLUDED.apellido,
    activo = TRUE;

-- Rol "Super Admin" para el admin
INSERT INTO usuario_roles (usuario_id, rol_id)
SELECT u.id, r.id
FROM usuarios u
JOIN roles r ON r.nombre = 'Super Admin'
WHERE u.email = 'admin@miempresa.com'
AND NOT EXISTS (
  SELECT 1 FROM usuario_roles ur WHERE ur.usuario_id = u.id AND ur.rol_id = r.id
);


---
init-scripts\07-sample-collaborators.sql

-- 07-sample-collaborators.sql 
CREATE EXTENSION IF NOT EXISTS pgcrypto; 
-- Asegurar rol Colaborador 
INSERT INTO roles (nombre, descripcion) VALUES ('Colaborador','Usuario colaborador b√°sico') ON CONFLICT (nombre) DO NOTHING;
-- Tres cuentas demo (password: user123) 
INSERT INTO usuarios (email, password_hash, nombre, apellido, activo) VALUES 
('colab1@miempresa.com', crypt('user123', gen_salt('bf')), 'Colab', 'Uno', TRUE), 
('colab2@miempresa.com', crypt('user123', gen_salt('bf')), 'Colab', 'Dos', TRUE), 
('colab3@miempresa.com', crypt('user123', gen_salt('bf')), 'Colab', 'Tres', TRUE) 
ON CONFLICT (email) DO NOTHING; 
-- Asignar rol Colaborador 
INSERT INTO usuario_roles (usuario_id, rol_id) 
SELECT u.id, r.id 
FROM usuarios u 
JOIN roles r ON r.nombre='Colaborador' 
WHERE u.email IN ('colab1@miempresa.com','colab2@miempresa.com','colab3@miempresa.com') 
ON CONFLICT (usuario_id, rol_id) DO NOTHING;

---
init-scripts\08-project-membership.sql

-- 08-project-membership.sql
-- Relaci√≥n proyecto <-> usuario (membres√≠as)
CREATE TABLE IF NOT EXISTS proyecto_miembros (
  id SERIAL PRIMARY KEY,
  proyecto_id INTEGER NOT NULL REFERENCES proyectos(id) ON DELETE CASCADE,
  usuario_id INTEGER NOT NULL REFERENCES usuarios(id) ON DELETE CASCADE,
  rol_en_proyecto VARCHAR(30) DEFAULT 'MIEMBRO',
  creado_en TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE (proyecto_id, usuario_id)
);

-- √çndices √∫tiles
CREATE INDEX IF NOT EXISTS idx_proyecto_miembros_proyecto ON proyecto_miembros(proyecto_id);
CREATE INDEX IF NOT EXISTS idx_proyecto_miembros_usuario ON proyecto_miembros(usuario_id);


---
pgadmin-data\pgadmin4.db

SQLite format 3   @    Ú   +           Ü                                                Ú .ç˘   ˆ    #˚ˆ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             %efbbe5d5862f
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          %	efbbe5d5862f   Ú Ú                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ConfigDB0
   Ù Ù                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          	ConfigDB   v ”v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ÇZ /ÖUserpgAdmin User Roleobject_register_server,tools_erd_tool,tools_query_tool,tools_debugger,tools_psql_tool,tools_backup,tools_restore,tools_import_export_data,tools_import_export_servers,tools_search_objects,tools_maintenance,tools_schema_diff,tools_grant_wizard,storage_add_folder,storage_remove_folder,change_password,list,change_password+ 'AAdministratorpgAdmin Administrator Role                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
   Ê ÔÊ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          User'	Administrator   í- ˆÈ÷…π¶ê|gI:)Ú÷∂ûãscH&˝‰Œ∏ûÇgE,Êƒ§ÑhN;	ÓŸ¬¨ó}dF0 
È
“
ø
ß
î
u
R
-
	˘	⁄	…	∂	ù	à	j	P	+	Ô÷∫£âjP9¯‡ƒ£~bF$ˇ›æ£ÜmL2È—∫°âs\;%Á“Ω®íz]:!ÊŒ±ïvaF,ÂºüÜnV=$ÛŸ¬™ëyfQ- !Å Elong_running_query_thresholdÅ 'show_activityÅ #show_graphsÅ -io_stats_refreshÅ /pmu_stats_refreshÅ -sm_stats_refreshÅ +m_stats_refreshÅ 1pcpu_stats_refreshÅ
 -la_stats_refreshÅ	 /cpu_stats_refreshÅ /hpc_stats_refreshÅ /bio_stats_refreshÅ -to_stats_refreshÅ -ti_stats_refreshÅ /tps_stats_refreshÅ 7session_stats_refresh&Å Oshow_node_pgd_replication_servers%Å Mshow_node_pgd_replication_groupsÅ  ;show_node_replica_nodes 3show_node_directory~ 5show_node_tablespace} )show_node_role| =show_node_resource_group{ 7show_node_pga_jobstepz 9show_node_pga_scheduley /show_node_pga_jobx ;show_node_dbms_schedulew 9show_node_dbms_programv 1show_node_dbms_job!u Eshow_node_dbms_job_schedulert 9show_node_subscriptions /show_node_catalogr +show_node_mviewq )show_node_viewp )show_node_typeo )show_node_rule"n Gshow_node_row_security_policym 3show_node_partitionl +show_node_indexk Ashow_node_compound_triggerj -show_node_columni +show_node_tableh /show_node_synonymg 1show_node_sequencef -show_node_edbvare /show_node_edbprocd /show_node_edbfuncc /show_node_packageb 1show_node_operatora 3show_node_procedure` Ashow_node_trigger_function_ 1show_node_function^ 9show_node_fts_template] 5show_node_fts_parser\ =show_node_fts_dictionary [ Cshow_node_fts_configuration#Z Ishow_node_foreign_table_column Y Cshow_node_unique_constraintX 7show_node_primary_keyW 7show_node_foreign_key#V Ishow_node_exclusion_constraintU Ashow_node_check_constraintT 7show_node_constraintsS /show_node_triggerR ;show_node_foreign_table!Q Eshow_node_domain_constraintsP -show_node_domainO 3show_node_collationN =show_node_catalog_objectM 3show_node_aggregateL -show_node_schemaK 7show_node_publicationJ 1show_node_languageI 9show_node_user_mappingH =show_node_foreign_server#G Ishow_node_foreign_data_wrapperF 3show_node_extensionE ;show_node_event_triggerD )show_node_castC 1show_node_databaseB %
ppas_bin_dirA !
pg_bin_dir@ =	breadcrumbs_show_comment? 1	breadcrumbs_enable> 5new_browser_tab_open#= Idebugger_tab_title_placeholder!< Evw_edt_tab_title_placeholder; =qt_tab_title_placeholder: %dynamic_tabs9 /open_quick_search8 %add_grid_row7 -sub_menu_refresh6 -direct_debugging5 +sub_menu_delete4 3sub_menu_properties3 +sub_menu_create2 ;sub_menu_search_objects1 1sub_menu_view_data0 3sub_menu_query_tool/ )main_menu_help. +main_menu_tools- -main_menu_object, )main_menu_file+ 5tabbed_panel_forward* +close_tab_panel) 7tabbed_panel_backward( %browser_tree' 3process_retain_days& 7pgagent_row_threshold% ?table_row_count_threshold$ ?auto_expand_sole_children # Cconfirm_on_properties_close" =confirm_on_refresh_close%! Mbrowser_tree_state_save_interval  1hide_shared_server  Cshow_user_defined_templates 5show_column_datatype 7show_empty_coll_nodes 3show_system_objects +indent_new_line +sql_font_family 1sql_font_ligatures 'sql_font_size )brace_matching  Chighlight_selection_matches 5insert_pair_brackets wrap_code /cursor_blink_rate %code_folding /plain_editor_mode ?new_line_before_semicolon 7lines_between_queries ?logical_operator_new_line -expression_width !use_spaces tab_size
 ;spaces_around_operators	 )data_type_case 'function_case +identifier_case %keyword_case 	!format_sql 	comment 	'goto_line_col 	replace 	find   ı ı                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           	 server   ˚ ˚                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 		   Û Û                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          	Servers
   Ù Ù                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          		Servers   l[ ıË›œ≈¥®íÇxfXA.¯‚–ª´òÄaN>"˙ÂÀ≠òÉhJ/Ì€¡ÆúãziYG6'˝Ó€æ∞¢îÖt^B0
Ú
‹
«
Ø
°
ç
z
c
C
"

	˙	Ò	Ë	⁄	–	∆	∏	∞	•	î	Ö	t	e	W	G	9	,	"		
	Òﬂ≈µ¨†ê}o[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           l +user_managementk sqleditorj )search_objectsi #schema_diff
h restoreg psqlf #maintenancee 7import_export_serversd 'import_exportc %grant_wizardb erda debugger	` backup_ tools^ settings] redirects\ #preferences[ workspaceZ !statisticsY %file_managerX !dependentsW %dependencies	V googleU rdsT biganimalS azureR cloudQ bgprocessP miscO help	N graphsM !dashboardsL dashboardK ENODE-pgd_replication_serversJ CNODE-pgd_replication_groupsI 1NODE-replica_nodesH )NODE-directoryG +NODE-tablespaceF NODE-roleE 3NODE-resource_groupD -NODE-pga_jobstepC /NODE-pga_scheduleB %NODE-pga_jobA 1NODE-dbms_schedule@ /NODE-dbms_program? 'NODE-dbms_job> ;NODE-dbms_job_scheduler= /NODE-subscription< %NODE-catalog; !NODE-mview: NODE-view9 NODE-type8 NODE-rule7 =NODE-row_security_policy6 )NODE-partition5 !NODE-index4 7NODE-compound_trigger3 #NODE-column2 !NODE-table1 %NODE-synonym0 'NODE-sequence/ #NODE-edbvar. %NODE-edbproc- %NODE-edbfunc, %NODE-package+ 'NODE-operator* )NODE-procedure) 7NODE-trigger_function( 'NODE-function' /NODE-fts_template& +NODE-fts_parser% 3NODE-fts_dictionary$ 9NODE-fts_configuration# ?NODE-foreign_table_column" 9NODE-unique_constraint! -NODE-primary_key  -NODE-foreign_key ?NODE-exclusion_constraint 7NODE-check_constraint -NODE-constraints %NODE-trigger 1NODE-foreign_table ;NODE-domain_constraints #NODE-domain )NODE-collation ANODE-catalog_object_column 3NODE-catalog_object )NODE-aggregate #NODE-schema -NODE-publication 'NODE-language /NODE-user_mapping 3NODE-foreign_server ?NODE-foreign_data_wrapper )NODE-extension 1NODE-event_trigger NODE-cast 'NODE-database
 paths	 #NODE-server /NODE-server_group
 browser %authenticate about webserver	 oauth2 kerberos	 editor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Ë‘«π®òlZJ?. ÛÂÃ≥•óâ{jWI0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -kgraph_visualiser +kauto_completion 1kkeyboard_shortcuts kdisplay %kResults_grid !kCSV_output kOptions kExplain idisplay boptions 1bkeyboard_shortcuts 1akeyboard_shortcuts Yoptions )Puser_interface	 
help Ngraphs Mdisplay !Mdashboards	 node
 
bin_paths	 #breadcrumbs %tab_settings 1keyboard_shortcuts processes !properties display 	options 	)sql_formatting 	1keyboard_shortcuts   ˙    ˙                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
Å   ˆ ˆ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            	 ôes
   ˘ ˘                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               		 ô                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              `  Tïfˇìd)é
®	œ·	éAÍªvªH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ÉFÜctableprocessprocessCREATE TABLE process (
	user_id INTEGER NOT NULL, 
	pid VARCHAR NOT NULL, 
	"desc" VARCHAR NOT NULL, 
	command VARCHAR NOT NULL, 
	arguments VARCHAR, 
	start_time VARCHAR, 
	end_time VARCHAR, 
	logdir VARCHAR, 
	exit_code INTEGER, 
	acknowledge VARCHAR, utility_pid INTEGER, process_state INTEGER DEFAULT '0', server_id INTEGER DEFAULT '0', 
	PRIMARY KEY (pid), 
	FOREIGN KEY(user_id) REFERENCES "user" (id) ON DELETE CASCADE
)Ç5--Ñtableuser_preferencesuser_preferencesCREATE TABLE user_preferences (
	pid INTEGER NOT NULL, 
	uid INTEGER NOT NULL, 
	value VARCHAR(1024) NOT NULL, 
	PRIMARY KEY (pid, uid), 
	FOREIGN KEY(pid) REFERENCES preferences (id) ON DELETE CASCADE, 
	FOREIGN KEY(uid) REFERENCES "user" (id) ON DELETE CASCADE
)Åc##Étableroles_usersroles_usersCREATE TABLE roles_users (
	user_id INTEGER, 
	role_id INTEGER, 
	FOREIGN KEY(role_id) REFERENCES role (id) ON DELETE CASCADE, 
	FOREIGN KEY(user_id) REFERENCES "user" (id) ON DELETE CASCADE
)Å9ÇUtableroleroleCREATE TABLE role (
	id INTEGER NOT NULL, 
	name VARCHAR(128) NOT NULL, 
	description VARCHAR(256) NOT NULL, permissions TEXT, 
	PRIMARY KEY (id), 
	UNIQUE (name)
)-A indexsqlite_autoindex_process_1processUiC indexsqlite_autoindex_debugger_function_arguments_1debugger_function_argumentsÑJCCàtabledebugger_function_argumentsdebugger_function_argumentsCREATE TABLE debugger_function_arguments (
	server_id INTEGER NOT NULL, 
	database_id INTEGER NOT NULL, 
	schema_id INTEGER NOT NULL, 
	function_id INTEGER NOT NULL, 
	arg_id INTEGER NOT NULL, 
	is_null INTEGER NOT NULL, 
	is_expression INTEGER NOT NULL, 
	use_default INTEGER, 
	value VARCHAR NOT NULL, 
	PRIMARY KEY (server_id, database_id, schema_id, function_id, arg_id), 
	CHECK (is_null >= 0 AND is_null <= 1), 
	CHECK (is_expression >= 0 AND is_expression <= 1), 
	CHECK (use_default >= 0 AND use_default <= 1)
)?S- indexsqlite_autoindex_user_preferences_1user_preferencesÅV##ÇstablepreferencespreferencesCREATE TABLE preferences (
	id INTEGER NOT NULL, 
	cid INTEGER NOT NULL, 
	name VARCHAR(256) NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(cid) REFERENCES preference_category (id)
)Åc33Çmtablepreference_categorypreference_categoryCREATE TABLE preference_category (
	id INTEGER NOT NULL, 
	mid INTEGER, 
	name VARCHAR(256) NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(mid) REFERENCES module_preference (id)
)Å//Å_tablemodule_preferencemodule_preferenceCREATE TABLE module_preference (
	id INTEGER NOT NULL, 
	name VARCHAR(256) NOT NULL, 
	PRIMARY KEY (id)
)5I# indexsqlite_autoindex_servergroup_1servergroupd Å}##ÉAtableservergroupservergroupCREATE TABLE servergroup (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	name VARCHAR(128) NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES "user" (id) ON DELETE CASCADE, 
	UNIQUE (user_id, name)
)º /                                           '	; indexsqlite_autoindex_role_1role	   ™                                                                                                                                                                      -A indexsqlite_autoindex_version_1version~ÅStableversionversionCREATE TABLE version (
	name VARCHAR(32) NOT NULL, 
	value INTEGER NOT NULL, 
	PRIMARY KEY (name)
)=Q+ indexsqlite_autoindex_alembic_version_1alembic_versionÅ)++Ç	tablealembic_versionalembic_versionCREATE TABLE alembic_version (
	version_num VARCHAR(32) NOT NULL, 
	CONSTRAINT alembic_version_pkc PRIMARY KEY (version_num)
)M  ëh’ñ
∑
Ü	∫$8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /.C indexsqlite_autoindex_user_mfa_1user_mfa Åi-É%tableuser_mfauser_mfaCREATE TABLE user_mfa (
	user_id INTEGER NOT NULL, 
	mfa_auth VARCHAR(256) NOT NULL, 
	options VARCHAR, 
	PRIMARY KEY (user_id, mfa_auth), 
	FOREIGN KEY(user_id) REFERENCES "user" (id) ON DELETE CASCADE
)',; indexsqlite_autoindex_user_1user'—m                                                                                                                                                                                                                                                                                                                                                                         ÅI'Çmtablemacrosmacros!CREATE TABLE macros (
	id INTEGER NOT NULL, 
	alt BOOLEAN NOT NULL, 
	control BOOLEAN NOT NULL, 
	"key" VARCHAR(128) NOT NULL, 
	key_code INTEGER NOT NULL, 
	PRIMARY KEY (id)
)/$C indexsqlite_autoindex_database_1databaseÅ\#ÉtabledatabasedatabaseCREATE TABLE "database" (
	id INTEGER NOT NULL, 
	schema_res VARCHAR, 
	server INTEGER NOT NULL, 
	PRIMARY KEY (id, server), 
	FOREIGN KEY(server) REFERENCES "server" (id) ON DELETE CASCADE
)9M' indexsqlite_autoindex_query_history_1query_history É''Ö_tablequery_historyquery_historyCREATE TABLE query_history (
	srno INTEGER NOT NULL, 
	uid INTEGER NOT NULL, 
	sid INTEGER NOT NULL, 
	dbname VARCHAR NOT NULL, 
	query_info VARCHAR NOT NULL, 
	last_updated_flag VARCHAR NOT NULL, 
	PRIMARY KEY (srno, uid, sid, dbname), 
	FOREIGN KEY(sid) REFERENCES "server" (id) ON DELETE CASCADE, 
	FOREIGN KEY(uid) REFERENCES "user" (id) ON DELETE CASCADE
)'; indexsqlite_autoindex_keys_1keysqÅEtablekeyskeysCREATE TABLE keys (
	name VARCHAR NOT NULL, 
	value VARCHAR NOT NULL, 
	PRIMARY KEY (name)
)                   Ée+á-tableuseruser"CREATE TABLE "user" (
	id INTEGER NOT NULL, 
	email VARCHAR(256), 
	password VARCHAR, 
	active BOOLEAN NOT NULL, 
	confirmed_at DATETIME, 
	masterpass_check VARCHAR(256), 
	username VARCHAR(256) DEFAULT ('') NOT NULL, 
	auth_source VARCHAR(256) DEFAULT 'internal' NOT NULL, 
	fs_uniquifier VARCHAR NOT NULL, locked BOOLEAN DEFAULT 'false', login_attempts INTEGER DEFAULT '0', 
	PRIMARY KEY (id), 
	CONSTRAINT user_unique_constraint UNIQUE (username, auth_source)
)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 = øÑ=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               E9eSECURITY_PASSWORD_SALTydCO3XiQTS6mr9nWC3H5-Rhlr_nAIR_GwesTl2iSbwI=9!eSECRET_KEYGk6MI7WIXGJc9W3UB-trJ2HLcO4slEv48DPF3ZUL4Cg=?-eCSRF_SESSION_KEY74Too7FflJdAa56A-hHQ-wHXreiOoa24EmhXoH1qXuE=
   ¬ Ï›¬                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    9SECURITY_PASSWORD_SALT!SECRET_KEY-	CSRF_SESSION_KEY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 u! ÁÀ≤ìp\G:,˘·√Øó~m]H3˘·ÃªßìhT>*Ù‚Õª®îÇn[L<'Ô÷¬®î{fO:#
ˆ
ﬁ
À
Ø
ô
Ü
q
\
;
	˛	›	ø	®	Ö	g	?	,	˚›¡¢~_B!ÁŒ™àr\K6ÓŸ»¥üäwbL3˛ÊŒªû}cG2!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Ç row_limitÇ 'auto_completeÇ 5rollback_transactionÇ 1commit_transactionÇ ?autocomplete_on_key_pressÇ 7keywords_in_uppercaseÇ #toggle_caseÇ  -btn_edit_optionsÅ -btn_cancel_queryÅ~ 3btn_execute_optionsÅ} 1btn_filter_optionsÅ| /btn_filter_dialogÅ{ )btn_delete_rowÅz 'btn_paste_rowÅy #btn_add_rowÅx 'btn_save_fileÅw 'btn_open_fileÅv %switch_panelÅu move_nextÅt 'move_previousÅs -download_resultsÅr #clear_queryÅq 7explain_analyze_queryÅp 'explain_queryÅo save_dataÅn )execute_cursorÅm )execute_scriptÅl Aquery_success_notification!Åk Econnection_status_fetch_timeÅj /connection_status#Åi Imax_column_data_display_lengthÅh %striped_rowsÅg ?data_result_rows_per_pageÅf 7column_data_max_widthÅe ;column_data_auto_resize!Åd Eresults_grid_field_separatorÅc ;results_grid_quote_charÅb 5results_grid_quotingÅa 9csv_replace_nulls_withÅ` 3csv_field_separatorÅ_ )csv_quote_charÅ^ #csv_quoting%Å] Munderlined_query_execute_warningÅ\ 9underline_query_cursor Å[ Cview_edit_promotion_warningÅZ +open_in_new_tabÅY 9copy_sql_to_query_toolÅX ?prompt_commit_transactionÅW =prompt_save_data_changesÅV 7table_view_data_by_pkÅU ?prompt_save_query_changesÅT 'server_cursorÅS 'auto_rollbackÅR #auto_commitÅQ )explain_memoryÅP 5explain_generic_planÅO #explain_walÅN -explain_settingsÅM +explain_summaryÅL )explain_timingÅK +explain_buffersÅJ 'explain_costsÅI +explain_verboseÅH 'ignore_grantsÅG /ignore_tablespaceÅF %ignore_ownerÅE 1ignore_whitespacesÅD %format_pgerdÅC /image_pixel_ratioÅB 5cardinality_notationÅA 5table_relation_depthÅ@ 'sql_with_dropÅ? zoom_outÅ> zoom_inÅ= #zoom_to_fitÅ< %show_detailsÅ; !auto_alignÅ: %many_to_manyÅ9 #one_to_manyÅ8 !one_to_oneÅ7 'add_edit_noteÅ6 !drop_tableÅ5 #clone_tableÅ4 !edit_tableÅ3 add_tableÅ2 %search_tableÅ1 )download_imageÅ0 %generate_sqlÅ/ +save_project_asÅ. %save_projectÅ- %open_projectÅ, %switch_panelÅ+ move_nextÅ* 'move_previousÅ) -edit_grid_valuesÅ( 7btn_clear_breakpointsÅ' 7btn_toggle_breakpointÅ& 'btn_step_overÅ% 'btn_step_intoÅ$ btn_stopÅ# btn_startÅ" /show_hidden_filesÅ! -file_dialog_viewÅ  %last_storageÅ 9last_directory_visitedÅ -file_upload_sizeÅ )save_app_stateÅ 7open_in_res_workspaceÅ layout
Å themeÅ 'user_languageÅ %pg_help_path Å Cpgd_replication_lag_refreshÅ ;graph_line_border_widthÅ /graph_mouse_trackÅ 5use_diff_point_styleÅ /graph_data_points
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ˆÏ‚ÿŒƒ∫∞¶úëÜ{peZOD9-!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
 	F12{
 	F11z
 	F10y	 	F9x	 	F8w	 	F7v	 	F6u	 	F5t	 	F4s	 	F3r	 	F2q	 	F1p
 	00	 	99 	88 	77 	66 	55 	44 	33 	22 	11   ∑ ∑                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ÇF 3Ç	 Å]3Madmin@miempresa.com$pbkdf2-sha512$25000$ppRS6v2fUypF6H0vxViLMQ$XJgWZ1H.2lEPMAjrYiGYC/XjKjSHCgivKiVfwgGFuK4T9jy1YRMUjLDWdnWS9gWy.YgBR1rkZpJiRJ2xbjwY9A3143516d347a347a4866625843707a73615574564b744b3756445637732b6767784b47625530486d4e72334c332f51614b513d3dadmin@miempresa.cominternal71d048001f8841edb9ecebe82b8db200   
 
Ôùe(a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  à1%%èytablesharedserversharedserver(CREATE TABLE "sharedserver" (
	id INTEGER NOT NULL, 
	user_id INTEGER NOT NULL, 
	server_owner VARCHAR(64), 
	servergroup_id INTEGER NOT NULL, 
	name VARCHAR(128) NOT NULL, 
	host VARCHAR(128), 
	port INTEGER, 
	maintenance_db VARCHAR(64), 
	username VARCHAR(64), 
	password VARCHAR, 
	role VARCHAR(64), 
	comment VARCHAR(1024), 
	discovery_id VARCHAR(128), 
	db_res VARCHAR, 
	bgcolor VARCHAR(10), 
	fgcolor VARCHAR(10), 
	service VARCHAR, 
	use_ssh_tunnel INTEGER DEFAULT '0', 
	tunnel_host VARCHAR, 
	tunnel_port VARCHAR, 
	tunnel_username VARCHAR, 
	tunnel_authentication INTEGER DEFAULT '0', 
	tunnel_identity_file VARCHAR, 
	shared BOOLEAN NOT NULL, 
	save_password INTEGER DEFAULT '0', 
	tunnel_password VARCHAR, 
	osid INTEGER, 
	connection_params JSON, prepare_threshold INTEGER, tunnel_keep_alive INTEGER DEFAULT '0', tunnel_prompt_password INTEGER DEFAULT '0', 
	PRIMARY KEY (id), 
	FOREIGN KEY(servergroup_id) REFERENCES servergroup (id), 
	FOREIGN KEY(user_id) REFERENCES user (id) ON DELETE CASCADE
)âs8ìAtableserverserver%CREATE TABLE "server" (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
	user_id INTEGER NOT NULL, 
	servergroup_id INTEGER NOT NULL, 
	name VARCHAR(128) NOT NULL, 
	host VARCHAR(128), 
	port INTEGER, 
	maintenance_db VARCHAR(64), 
	username VARCHAR(64), 
	comment VARCHAR(1024), 
	password VARCHAR, 
	role VARCHAR(64), 
	discovery_id VARCHAR, 
	db_res VARCHAR, 
	bgcolor VARCHAR(10), 
	fgcolor VARCHAR(10), 
	service VARCHAR, 
	use_ssh_tunnel INTEGER DEFAULT '0', 
	tunnel_host VARCHAR, 
	tunnel_port VARCHAR, 
	tunnel_username VARCHAR, 
	tunnel_authentication INTEGER DEFAULT '0', 
	tunnel_identity_file VARCHAR, 
	tunnel_password VARCHAR, 
	save_password INTEGER DEFAULT '0', 
	shared BOOLEAN, 
	kerberos_conn BOOLEAN DEFAULT 'false', 
	cloud_status INTEGER DEFAULT '0', 
	passexec_cmd VARCHAR, 
	passexec_expiration INTEGER, 
	connection_params JSON, 
	shared_username VARCHAR(64), 
	prepare_threshold INTEGER, 
	tunnel_keep_alive INTEGER DEFAULT '0', 
	tags JSON, 
	is_adhoc INTEGER DEFAULT '0', post_connection_sql VARCHAR, db_res_type VARCHAR(32) DEFAULT 'databases', tunnel_prompt_password INTEGER DEFAULT '0', 
	FOREIGN KEY(servergroup_id) REFERENCES servergroup (id), 
	FOREIGN KEY(user_id) REFERENCES user (id) ON DELETE CASCADE
)A<U/ indexsqlite_autoindex_application_state_1application_state+Ç;//É1tableapplication_stateapplication_state*CREATE TABLE "application_state" (
	uid INTEGER NOT NULL, 
	id INTEGER NOT NULL, 
	connection_info JSON, 
	tool_data VARCHAR, 
	PRIMARY KEY (id, uid), 
	FOREIGN KEY(uid) REFERENCES user (id) ON DELETE CASCADE
)Ç57##Ñ1tableuser_macrosuser_macros$CREATE TABLE user_macros (
	id INTEGER NOT NULL, 
	mid INTEGER, 
	uid INTEGER NOT NULL, 
	name VARCHAR(1024) NOT NULL, 
	sql VARCHAR, 
	PRIMARY KEY (id), 
	FOREIGN KEY(mid) REFERENCES macros (id) ON DELETE CASCADE, 
	FOREIGN KEY(uid) REFERENCES user (id) ON DELETE CASCADE
)P5++Ytablesqlite_sequencesqlite_sequenceCREATE TABLE sqlite_sequence(name,seq)-3A indexsqlite_autoindex_setting_1setting)Å_2Établesettingsetting&CREATE TABLE "setting" (
	user_id INTEGER NOT NULL, 
	setting VARCHAR(256) NOT NULL, 
	value TEXT, 
	PRIMARY KEY (user_id, setting), 
	FOREIGN KEY(user_id) REFERENCES user (id) ON DELETE CASCADE
)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               è „©è                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 	1browser_tree_state{}Ü7	)åUBrowser/Layout{"dockbox":{"id":"+2","size":200,"mode":"horizontal","children":[{"id":"+3","size":20,"tabs":[{"id":"id-object-explorer"}],"group":"object-explorer","activeId":"id-object-explorer"},{"id":"id-main","size":80,"tabs":[{"id":"id-dashboard"},{"id":"id-properties"},{"id":"id-sql"},{"id":"id-statistics"},{"id":"id-dependencies"},{"id":"id-dependents"},{"id":"id-processes"}],"group":"playground","activeId":"id-dashboard","panelLock":{"panelStyle":"playground"}}]},"floatbox":{"id":"+22","size":0,"mode":"float","children":[{"id":"+34","size":200,"tabs":[{"id":"id-edit-properties59"}],"group":"dialogs","activeId":"id-edit-properties59","x":256.5,"y":0.2,"z":1,"w":700,"h":550}]},"windowbox":{"id":"+23","size":0,"mode":"window","children":[]},"maxbox":{"id":"+24","size":1,"mode":"maximize","children":[]}}	+LastUpdateCheck20260108
   ‡ ‡                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      3	admin@miempresa.cominternal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
   ¿ ÿÏ¿                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  	1browser_tree_state	)Browser/Layout	+	LastUpdateCheck                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

---
pgadmin-data\sessions\38fc4d07-c2cb-49dc-b18c-b3ce056792b4



---
pgadmin-data\sessions\4b1ff5cc-b9f2-46f3-bdd5-dbdafe0d126a

Äï∫       åfamw7a1sln213gxvgz4nîå,FmR6Z42ghvK0i88+6hh5a2NPNR7VD3cg7CTGTJx5meQ=î}î(å
_permanentîàå_freshîâå_paranoid_tokenîå@8ed0d99c77840c1b41ef60343a520cfe7dd0f1f5af899cd9881fa54d08094341îuáî.

---
pgadmin-data\sessions\a949e287-7881-47b5-b68d-e95d877ac0e1



---
pgadmin-data\sessions\ce1ddbb7-2813-4e25-8855-1364420d62fa

Äï`      å8mml4maizhdc5y4nu5xgîå,xascdWRnbBZmSHL4a7H+joJvvD67r0rrItaXfSkrjjY=î}î(å
_permanentîàå_freshîàå_paranoid_tokenîå@8ed0d99c77840c1b41ef60343a520cfe7dd0f1f5af899cd9881fa54d08094341îåfs_ccîåsetîå
csrf_tokenîå(b756efac65aa8816e9a11eadb8d5f50b3ce36bc4îåauth_source_managerî}î(åsource_friendly_nameîåinternoîåauth_sourcesî]îåinternalîaåcurrent_sourceîhuå_user_idîå 71d048001f8841edb9ecebe82b8db200îå_idîåÄff04aac8b0acac1d3e636457fd53ac84fa64121fcb6415ba065e8fced0d9087a81122319116328e06ee2b67a69e60409a316da3c24349ed8bd887816d60b6278îåfs_paaîGA⁄W ` ˚åmfa_authenticatedîàåallow_save_passwordîàuáî.

---
pgadmin-data\sessions\f603613f-31ad-4510-a1e4-54d59ae2b6a1

Äï∫       åxs0y9ybp8dytpw73okndîå,ag9s2R8rzOGcZrJCpDkNecCw4yhzyOLd3J8EaTEZgZQ=î}î(å
_permanentîàå_freshîâå_paranoid_tokenîå@8ed0d99c77840c1b41ef60343a520cfe7dd0f1f5af899cd9881fa54d08094341îuáî.

---
web\index.html

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ERP MVP</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>


---
web\package-lock.json

{
  "name": "erp-mvp-web",
  "version": "0.0.1",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "erp-mvp-web",
      "version": "0.0.1",
      "dependencies": {
        "react": "^18.3.1",
        "react-dom": "^18.3.1",
        "react-router-dom": "^6.26.1"
      },
      "devDependencies": {
        "@types/react": "^18.3.8",
        "@types/react-dom": "^18.3.0",
        "@vitejs/plugin-react": "^4.3.1",
        "typescript": "^5.6.2",
        "vite": "^5.4.1"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.27.1.tgz",
      "integrity": "sha512-cjQ7ZlQ0Mv3b47hABuTevyTuYN4i+loJKGeV9flcCgIK37cCXRh+L1bd3iBHlynerhQ7BhCkn2BPbQUL+rGqFg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.27.1",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.4.tgz",
      "integrity": "sha512-YsmSKC29MJwf0gF8Rjjrg5LQCmyh+j/nD8/eP7f+BeoQTKYqs9RoWbjGOdy0+1Ekr68RJZMUOPVQaQisnIo4Rw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.4.tgz",
      "integrity": "sha512-2BCOP7TN8M+gVDj7/ht3hsaO/B/n5oDbiAyyvnRlNOs+u1o+JWNYTQrmpuNp1/Wq2gcFrI01JAW+paEKDMx/CA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.3",
        "@babel/helper-compilation-targets": "^7.27.2",
        "@babel/helper-module-transforms": "^7.28.3",
        "@babel/helpers": "^7.28.4",
        "@babel/parser": "^7.28.4",
        "@babel/template": "^7.27.2",
        "@babel/traverse": "^7.28.4",
        "@babel/types": "^7.28.4",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.3.tgz",
      "integrity": "sha512-3lSpxGgvnmZznmBkCRnVREPUFJv2wrv9iAoFDvADJc0ypmdOxdUtcLeBgBJ6zE0PMeTKnxeQzyk0xTBq4Ep7zw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.28.3",
        "@babel/types": "^7.28.2",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.27.2.tgz",
      "integrity": "sha512-2+1thGUUWWjLTYTHZWK1n8Yga0ijBz1XAhUXcKy81rd5g6yh7hGqMp45v7cadSbEHc9G3OTv45SyneRN3ps4DQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.27.2",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.27.1.tgz",
      "integrity": "sha512-0gSFWUPNXNopqtIPQvlD5WgXYI5GY2kP2cCvoT8kczjbfcfuIljTbcWrulD1CIPIX2gt1wghbDy08yE1p+/r3w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.27.1",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.3",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.3.tgz",
      "integrity": "sha512-gytXUbs8k2sXS9PnQptz5o0QnpLL51SwASIORY6XaBKF88nsOT0Zw9szLqlSGQDP/4TljBAD5y98p2U1fqkdsw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1",
        "@babel/traverse": "^7.28.3"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.27.1.tgz",
      "integrity": "sha512-1gn1Up5YXka3YYAHGKpbideQ5Yjf1tDa9qYcgysz+cNCXukyLl6DjPXhD3VRwSb8c0J9tA4b2+rHEZtc6R0tlw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.27.1.tgz",
      "integrity": "sha512-D2hP9eA+Sqx1kBZgzxZh0y1trbuU+JoDkiEwqhQ36nodYqJwyEIhPSdMNd7lOm/4io72luTPWH20Yda0xOuUow==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.4.tgz",
      "integrity": "sha512-HFN59MmQXGHVyYadKLVumYsA9dBFun/ldYxipEjzA4196jpLZd8UjEEBLkbEkvfYreDqJhZxYAWFPtrfhNpj4w==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.4.tgz",
      "integrity": "sha512-yZbBqeM6TkpP9du/I2pUZnJsRMGGvOuIrhjzC1AwHwW+6he4mni6Bp/m8ijn0iOuZuPI2BfkCoSRunpyjnrQKg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.4"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.27.2",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.27.2.tgz",
      "integrity": "sha512-LPDZ85aEJyYSd18/DkjNh4/y1ntkE5KwUHWTiqgRxruuZL2F1yuHligVHLvcHY2vMHXttKFpJn6LwfI7cw7ODw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/parser": "^7.27.2",
        "@babel/types": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.4.tgz",
      "integrity": "sha512-YEzuboP2qvQavAcjgQNVgsvHIDv6ZpwXvcvjmyySP2DIMuByS/6ioU5G9pYrWHM6T2YDfc7xga9iNzYOs12CFQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.27.1",
        "@babel/generator": "^7.28.3",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.4",
        "@babel/template": "^7.27.2",
        "@babel/types": "^7.28.4",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.28.4",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.4.tgz",
      "integrity": "sha512-bkFqkLhh3pMBUQQkpVgWDWq/lqzc2678eUyDlTBhRqhCHFguYYGM0Efga7tYk4TogG/3x0EEl66/OQ+WGbWB/Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.30",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.30.tgz",
      "integrity": "sha512-GQ7Nw5G2lTu/BtHTKfXhKHok2WGetd4XYcVKGx00SjAk8GMwgJM3zr6zORiPGuOE+/vkc90KtTosSSvaCjKb2Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@remix-run/router": {
      "version": "1.23.0",
      "resolved": "https://registry.npmjs.org/@remix-run/router/-/router-1.23.0.tgz",
      "integrity": "sha512-O3rHJzAQKamUz1fvE0Qaw0xSFqsA/yafi2iqeE0pvdFtCO1viYx8QL6f3Ln/aCCTLxs68SLf0KPM9eSeM8yBnA==",
      "license": "MIT",
      "engines": {
        "node": ">=14.0.0"
      }
    },
    "node_modules/@rolldown/pluginutils": {
      "version": "1.0.0-beta.27",
      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@rollup/rollup-android-arm-eabi": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.50.0.tgz",
      "integrity": "sha512-lVgpeQyy4fWN5QYebtW4buT/4kn4p4IJ+kDNB4uYNT5b8c8DLJDg6titg20NIg7E8RWwdWZORW6vUFfrLyG3KQ==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-android-arm64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.50.0.tgz",
      "integrity": "sha512-2O73dR4Dc9bp+wSYhviP6sDziurB5/HCym7xILKifWdE9UsOe2FtNcM+I4xZjKrfLJnq5UR8k9riB87gauiQtw==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-darwin-arm64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.50.0.tgz",
      "integrity": "sha512-vwSXQN8T4sKf1RHr1F0s98Pf8UPz7pS6P3LG9NSmuw0TVh7EmaE+5Ny7hJOZ0M2yuTctEsHHRTMi2wuHkdS6Hg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-darwin-x64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.50.0.tgz",
      "integrity": "sha512-cQp/WG8HE7BCGyFVuzUg0FNmupxC+EPZEwWu2FCGGw5WDT1o2/YlENbm5e9SMvfDFR6FRhVCBePLqj0o8MN7Vw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-arm64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.50.0.tgz",
      "integrity": "sha512-UR1uTJFU/p801DvvBbtDD7z9mQL8J80xB0bR7DqW7UGQHRm/OaKzp4is7sQSdbt2pjjSS72eAtRh43hNduTnnQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-x64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.50.0.tgz",
      "integrity": "sha512-G/DKyS6PK0dD0+VEzH/6n/hWDNPDZSMBmqsElWnCRGrYOb2jC0VSupp7UAHHQ4+QILwkxSMaYIbQ72dktp8pKA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.50.0.tgz",
      "integrity": "sha512-u72Mzc6jyJwKjJbZZcIYmd9bumJu7KNmHYdue43vT1rXPm2rITwmPWF0mmPzLm9/vJWxIRbao/jrQmxTO0Sm9w==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.50.0.tgz",
      "integrity": "sha512-S4UefYdV0tnynDJV1mdkNawp0E5Qm2MtSs330IyHgaccOFrwqsvgigUD29uT+B/70PDY1eQ3t40+xf6wIvXJyg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.50.0.tgz",
      "integrity": "sha512-1EhkSvUQXJsIhk4msxP5nNAUWoB4MFDHhtc4gAYvnqoHlaL9V3F37pNHabndawsfy/Tp7BPiy/aSa6XBYbaD1g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-musl": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.50.0.tgz",
      "integrity": "sha512-EtBDIZuDtVg75xIPIK1l5vCXNNCIRM0OBPUG+tbApDuJAy9mKago6QxX+tfMzbCI6tXEhMuZuN1+CU8iDW+0UQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loongarch64-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loongarch64-gnu/-/rollup-linux-loongarch64-gnu-4.50.0.tgz",
      "integrity": "sha512-BGYSwJdMP0hT5CCmljuSNx7+k+0upweM2M4YGfFBjnFSZMHOLYR0gEEj/dxyYJ6Zc6AiSeaBY8dWOa11GF/ppQ==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.50.0.tgz",
      "integrity": "sha512-I1gSMzkVe1KzAxKAroCJL30hA4DqSi+wGc5gviD0y3IL/VkvcnAqwBf4RHXHyvH66YVHxpKO8ojrgc4SrWAnLg==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.50.0.tgz",
      "integrity": "sha512-bSbWlY3jZo7molh4tc5dKfeSxkqnf48UsLqYbUhnkdnfgZjgufLS/NTA8PcP/dnvct5CCdNkABJ56CbclMRYCA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-musl": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.50.0.tgz",
      "integrity": "sha512-LSXSGumSURzEQLT2e4sFqFOv3LWZsEF8FK7AAv9zHZNDdMnUPYH3t8ZlaeYYZyTXnsob3htwTKeWtBIkPV27iQ==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-s390x-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.50.0.tgz",
      "integrity": "sha512-CxRKyakfDrsLXiCyucVfVWVoaPA4oFSpPpDwlMcDFQvrv3XY6KEzMtMZrA+e/goC8xxp2WSOxHQubP8fPmmjOQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-gnu": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.50.0.tgz",
      "integrity": "sha512-8PrJJA7/VU8ToHVEPu14FzuSAqVKyo5gg/J8xUerMbyNkWkO9j2ExBho/68RnJsMGNJq4zH114iAttgm7BZVkA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-musl": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.50.0.tgz",
      "integrity": "sha512-SkE6YQp+CzpyOrbw7Oc4MgXFvTw2UIBElvAvLCo230pyxOLmYwRPwZ/L5lBe/VW/qT1ZgND9wJfOsdy0XptRvw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-openharmony-arm64": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.50.0.tgz",
      "integrity": "sha512-PZkNLPfvXeIOgJWA804zjSFH7fARBBCpCXxgkGDRjjAhRLOR8o0IGS01ykh5GYfod4c2yiiREuDM8iZ+pVsT+Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ]
    },
    "node_modules/@rollup/rollup-win32-arm64-msvc": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.50.0.tgz",
      "integrity": "sha512-q7cIIdFvWQoaCbLDUyUc8YfR3Jh2xx3unO8Dn6/TTogKjfwrax9SyfmGGK6cQhKtjePI7jRfd7iRYcxYs93esg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-ia32-msvc": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.50.0.tgz",
      "integrity": "sha512-XzNOVg/YnDOmFdDKcxxK410PrcbcqZkBmz+0FicpW5jtjKQxcW1BZJEQOF0NJa6JO7CZhett8GEtRN/wYLYJuw==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-msvc": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.50.0.tgz",
      "integrity": "sha512-xMmiWRR8sp72Zqwjgtf3QbZfF1wdh8X2ABu3EaozvZcyHJeU0r+XAnXdKgs4cCAp6ORoYoCygipYP1mjmbjrsg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.27.0",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.2"
      }
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/prop-types": {
      "version": "15.7.15",
      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
      "integrity": "sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/react": {
      "version": "18.3.24",
      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.24.tgz",
      "integrity": "sha512-0dLEBsA1kI3OezMBF8nSsb7Nk19ZnsyE1LLhB8r27KbgU5H4pvuqZLdtE+aUkJVoXgTVuA+iLIwmZ0TuK4tx6A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/prop-types": "*",
        "csstype": "^3.0.2"
      }
    },
    "node_modules/@types/react-dom": {
      "version": "18.3.7",
      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz",
      "integrity": "sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==",
      "dev": true,
      "license": "MIT",
      "peerDependencies": {
        "@types/react": "^18.0.0"
      }
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.7.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.28.0",
        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
        "@rolldown/pluginutils": "1.0.0-beta.27",
        "@types/babel__core": "^7.20.5",
        "react-refresh": "^0.17.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
      }
    },
    "node_modules/browserslist": {
      "version": "4.25.4",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.25.4.tgz",
      "integrity": "sha512-4jYpcjabC606xJ3kw2QwGEZKX0Aw7sgQdZCvIK9dhVSPh76BKo+C+btT1RRofH7B+8iNpEbgGNVWiLki5q93yg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "caniuse-lite": "^1.0.30001737",
        "electron-to-chromium": "^1.5.211",
        "node-releases": "^2.0.19",
        "update-browserslist-db": "^1.1.3"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001741",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001741.tgz",
      "integrity": "sha512-QGUGitqsc8ARjLdgAfxETDhRbJ0REsP6O3I96TAth/mVjh2cYzN2u+3AzPP3aVSm2FehEItaJw1xd+IGBXWeSw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/csstype": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.1.3.tgz",
      "integrity": "sha512-M1uQkMl8rQK/szD0LNhtqxIPLpimGm8sOBwU7lLnCpSbTyY3yeU1Vc7l4KT5zT4s/yOxHH5O7tIuuLOCnLADRw==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/debug": {
      "version": "4.4.1",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.1.tgz",
      "integrity": "sha512-KcKCqiftBJcZr++7ykoDIEwSa3XWowTfNPo92BYxjXiyYEVrUQh2aLyhxBCwww+heortUFxEJYcRzosstTEBYQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.214",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.214.tgz",
      "integrity": "sha512-TpvUNdha+X3ybfU78NoQatKvQEm1oq3lf2QbnmCEdw+Bd9RuIAY+hJTvq1avzHM0f7EJfnH3vbCnbzKzisc/9Q==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/esbuild": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.21.5",
        "@esbuild/android-arm": "0.21.5",
        "@esbuild/android-arm64": "0.21.5",
        "@esbuild/android-x64": "0.21.5",
        "@esbuild/darwin-arm64": "0.21.5",
        "@esbuild/darwin-x64": "0.21.5",
        "@esbuild/freebsd-arm64": "0.21.5",
        "@esbuild/freebsd-x64": "0.21.5",
        "@esbuild/linux-arm": "0.21.5",
        "@esbuild/linux-arm64": "0.21.5",
        "@esbuild/linux-ia32": "0.21.5",
        "@esbuild/linux-loong64": "0.21.5",
        "@esbuild/linux-mips64el": "0.21.5",
        "@esbuild/linux-ppc64": "0.21.5",
        "@esbuild/linux-riscv64": "0.21.5",
        "@esbuild/linux-s390x": "0.21.5",
        "@esbuild/linux-x64": "0.21.5",
        "@esbuild/netbsd-x64": "0.21.5",
        "@esbuild/openbsd-x64": "0.21.5",
        "@esbuild/sunos-x64": "0.21.5",
        "@esbuild/win32-arm64": "0.21.5",
        "@esbuild/win32-ia32": "0.21.5",
        "@esbuild/win32-x64": "0.21.5"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.20",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.20.tgz",
      "integrity": "sha512-7gK6zSXEH6neM212JgfYFXe+GmZQM+fia5SsusuBIUgnPheLFBmIPhtFoAQRj8/7wASYQnbDlHPVwY0BefoFgA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-refresh": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-router": {
      "version": "6.30.1",
      "resolved": "https://registry.npmjs.org/react-router/-/react-router-6.30.1.tgz",
      "integrity": "sha512-X1m21aEmxGXqENEPG3T6u0Th7g0aS4ZmoNynhbs+Cn+q+QGTLt+d5IQ2bHAXKzKcxGJjxACpVbnYQSCRcfxHlQ==",
      "license": "MIT",
      "dependencies": {
        "@remix-run/router": "1.23.0"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8"
      }
    },
    "node_modules/react-router-dom": {
      "version": "6.30.1",
      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-6.30.1.tgz",
      "integrity": "sha512-llKsgOkZdbPU1Eg3zK8lCn+sjD9wMRZZPuzmdWWX5SUs8OFkN5HnFVC0u5KMeMaC9aoancFI/KoLuKPqN+hxHw==",
      "license": "MIT",
      "dependencies": {
        "@remix-run/router": "1.23.0",
        "react-router": "6.30.1"
      },
      "engines": {
        "node": ">=14.0.0"
      },
      "peerDependencies": {
        "react": ">=16.8",
        "react-dom": ">=16.8"
      }
    },
    "node_modules/rollup": {
      "version": "4.50.0",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.50.0.tgz",
      "integrity": "sha512-/Zl4D8zPifNmyGzJS+3kVoyXeDeT/GrsJM94sACNg9RtUE0hrHa1bNPtRSrfHTMH5HjRzce6K7rlTh3Khiw+pw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "1.0.8"
      },
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=18.0.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "@rollup/rollup-android-arm-eabi": "4.50.0",
        "@rollup/rollup-android-arm64": "4.50.0",
        "@rollup/rollup-darwin-arm64": "4.50.0",
        "@rollup/rollup-darwin-x64": "4.50.0",
        "@rollup/rollup-freebsd-arm64": "4.50.0",
        "@rollup/rollup-freebsd-x64": "4.50.0",
        "@rollup/rollup-linux-arm-gnueabihf": "4.50.0",
        "@rollup/rollup-linux-arm-musleabihf": "4.50.0",
        "@rollup/rollup-linux-arm64-gnu": "4.50.0",
        "@rollup/rollup-linux-arm64-musl": "4.50.0",
        "@rollup/rollup-linux-loongarch64-gnu": "4.50.0",
        "@rollup/rollup-linux-ppc64-gnu": "4.50.0",
        "@rollup/rollup-linux-riscv64-gnu": "4.50.0",
        "@rollup/rollup-linux-riscv64-musl": "4.50.0",
        "@rollup/rollup-linux-s390x-gnu": "4.50.0",
        "@rollup/rollup-linux-x64-gnu": "4.50.0",
        "@rollup/rollup-linux-x64-musl": "4.50.0",
        "@rollup/rollup-openharmony-arm64": "4.50.0",
        "@rollup/rollup-win32-arm64-msvc": "4.50.0",
        "@rollup/rollup-win32-ia32-msvc": "4.50.0",
        "@rollup/rollup-win32-x64-msvc": "4.50.0",
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/typescript": {
      "version": "5.9.2",
      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.2.tgz",
      "integrity": "sha512-CWBzXQrc/qOkhidw1OzBTQuYRbfyxDXJMVJ1XNwUHGROVmuaeiEm3OslpZ1RV96d7SKKjZKrSJu3+t/xlw3R9A==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "tsc": "bin/tsc",
        "tsserver": "bin/tsserver"
      },
      "engines": {
        "node": ">=14.17"
      }
    },
    "node_modules/update-browserslist-db": {
      "version": "1.1.3",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.1.3.tgz",
      "integrity": "sha512-UxhIZQ+QInVdunkDAaiazvvT/+fXL5Osr0JZlJulepYu6Jd7qJtDZjlur0emRlT71EN3ScPoE7gvsuIKKNavKw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/vite": {
      "version": "5.4.19",
      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.19.tgz",
      "integrity": "sha512-qO3aKv3HoQC8QKiNSTuUM1l9o/XX3+c+VTgLHbJWHZGeTPVAg2XwazI9UWzoxjIJCGCV2zU60uqMzjeLZuULqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "^0.21.3",
        "postcss": "^8.4.43",
        "rollup": "^4.20.0"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^18.0.0 || >=20.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      },
      "peerDependencies": {
        "@types/node": "^18.0.0 || >=20.0.0",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "sass-embedded": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "sass-embedded": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC"
    }
  }
}


---
web\package.json

{
  "name": "erp-mvp-web",
  "private": true,
  "version": "0.0.1",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview --host"
  },
  "dependencies": {
    "react": "^18.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.26.1"
  },
  "devDependencies": {
    "@types/react": "^18.3.8",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react": "^4.3.1",
    "typescript": "^5.6.2",
    "vite": "^5.4.1"
  }
}


---
web\tsconfig.json

{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true
  },
  "include": ["src"]
}


---
web\vite.config.ts

import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  server: {
    host: "0.0.0.0",
    port: 5173,
    proxy: {
      // La API expone /api/* y /health
      "/api": {
        target: "http://api:8000",
        changeOrigin: true,
      },
      "/health": {
        target: "http://api:8000",
        changeOrigin: true,
      },
    },
  },
});


---
web\src\api.ts

// web/src/api.ts
export type User = {
  id: number; email: string; nombre: string; apellido: string;
  roles: { id: number; nombre: string }[];
};

export type Project = {
  id: number; uuid: string; codigo?: string | null;
  nombre: string; estado: string; prioridad: number;
  avance_pct?: number | null; presupuesto_monto?: number | null;
};

export type Task = {
  id: number; uuid: string; proyecto_id: number;
  titulo: string; estado: string; prioridad: number;
};

export type EstadoReportItem = { estado: string; cantidad: number };

const API = (import.meta as any).env?.VITE_API_URL ?? "http://localhost:8000";

const LS = {
  access: "erp.access_token",
  refresh: "erp.refresh_token",
  user: "erp.user",
};

function getAccessToken() { return localStorage.getItem(LS.access) || ""; }
function getRefreshToken() { return localStorage.getItem(LS.refresh) || ""; }
function setTokens(at?: string, rt?: string) {
  if (at) localStorage.setItem(LS.access, at);
  if (rt) localStorage.setItem(LS.refresh, rt);
}
export function logout() {
  localStorage.removeItem(LS.access);
  localStorage.removeItem(LS.refresh);
  localStorage.removeItem(LS.user);
}

async function raw(path: string, init: RequestInit = {}) {
  const url = path.startsWith("http") ? path : `${API}${path}`;
  return fetch(url, init);
}

async function request(path: string, init: RequestInit = {}, retried = false) {
  const headers: Record<string, string> = {
    "Content-Type": "application/json",
    ...(init.headers as any),
  };
  const at = getAccessToken();
  if (at) headers.Authorization = `Bearer ${at}`;

  let res = await raw(path, { ...init, headers });
  if (res.status === 401 && !retried) {
    const rt = getRefreshToken();
    if (!rt) throw new Error("No autenticado");
    const r = await raw("/api/auth/refresh", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ refresh_token: rt }),
    });
    if (r.ok) {
      const data = await r.json();
      setTokens(data.access_token);
      // reintenta 1 vez con nuevo AT
      const headers2 = { ...headers, Authorization: `Bearer ${getAccessToken()}` };
      res = await raw(path, { ...init, headers: headers2 });
    } else {
      logout();
      throw new Error("Sesi√≥n expirada");
    }
  }
  if (!res.ok) {
    const msg = (await res.text()) || `HTTP ${res.status}`;
    throw new Error(msg);
  }
  const text = await res.text();
  return text ? JSON.parse(text) : null;
}

// ---------- Auth ----------
export async function login(email: string, password: string) {
  const data = await request("/api/auth/login", {
    method: "POST",
    body: JSON.stringify({ email, password }),
  });
  setTokens(data.access_token, data.refresh_token);
  localStorage.setItem(LS.user, JSON.stringify(data.user));
  return data.user as User;
}

export function currentUser(): User | null {
  const raw = localStorage.getItem(LS.user);
  return raw ? JSON.parse(raw) : null;
}

export function isLoggedIn() {
  return !!getAccessToken();
}

// ---------- Projects ----------
export async function fetchProjects(): Promise<Project[]> {
  return request("/api/projects", { method: "GET" });
}
export async function createProject(payload: {
  codigo?: string; nombre: string; descripcion?: string; prioridad?: number;
}): Promise<Project> {
  return request("/api/projects", { method: "POST", body: JSON.stringify(payload) });
}

// ---------- Tasks ----------
export async function fetchTasks(projectId: number): Promise<Task[]> {
  return request(`/api/projects/${projectId}/tasks`);
}
export async function createTask(payload: {
  proyecto_id: number; titulo: string; descripcion?: string; prioridad?: number;
}): Promise<Task> {
  return request(`/api/projects/tasks`, { method: "POST", body: JSON.stringify(payload) });
}
export async function patchTask(taskId: number, partial: Partial<Task>): Promise<Task> {
  return request(`/api/projects/tasks/${taskId}`, { method: "PATCH", body: JSON.stringify(partial) });
}

// ---------- Report ----------
export async function fetchEstadoReport(projectId: number): Promise<EstadoReportItem[]> {
  return request(`/api/projects/${projectId}/report/estado`);
}


---
web\src\App.tsx

// web/src/App.tsx
import React from "react";
import { Link, Outlet } from "react-router-dom";
import { useAuth } from "./auth/AuthContext";

export default function App() {
  const { user, logout } = useAuth();
  return (
    <div>
      <header style={{display:"flex", alignItems:"center", justifyContent:"space-between", padding:"12px 16px", borderBottom:"1px solid #eee"}}>
        <div style={{display:"flex", gap:12, alignItems:"center"}}>
          <strong>ERP MVP</strong>
          <Link to="/projects">Proyectos</Link>
        </div>
        <div>
          {user ? (
            <>
              <span style={{marginRight:12, opacity:.8}}>
                {user.nombre} {user.apellido}
              </span>
              <button onClick={logout}>Salir</button>
            </>
          ) : <Link to="/login">Ingresar</Link>}
        </div>
      </header>
      <Outlet />
    </div>
  );
}


---
web\src\authHelpers.ts

// src/auth.ts
import { api, tokenStore, User } from './api';

export type AuthState = {
  user: User | null;
  loading: boolean;
};

export async function doLogin(email: string, password: string): Promise<User> {
  const user = await api.login(email, password);
  return user;
}

export function doLogout() {
  tokenStore.clear();
  // Nada m√°s: el AuthContext se encargar√° de limpiar el user en memoria
}

export function hasRole(user: User | null, roleName: string): boolean {
  if (!user) return false;
  return (user.roles || []).some(r => r.nombre === roleName);
}


---
web\src\main.tsx

// web/src/main.tsx
import React from "react";
import ReactDOM from "react-dom/client";
import { createBrowserRouter, Navigate, RouterProvider } from "react-router-dom";
import App from "./App";
import { AuthProvider, useAuth } from "./auth/AuthContext";
import ProtectedRoute from "./components/ProtectedRoute";
import Login from "./pages/Login";
import Projects from "./pages/Projects";
import ProjectDetail from "./pages/ProjectDetail";
import "./tiny.css";


function RootRedirect() {
  const { user } = useAuth();
  return <Navigate to={user ? "/projects" : "/login"} replace />;
}

const router = createBrowserRouter([
  {
    path: "/",
    element: <App />,
    children: [
      { index: true, element: <RootRedirect /> },
      { path: "login", element: <Login /> },
      {
        element: <ProtectedRoute />,
        children: [
          { path: "projects", element: <Projects /> },
          { path: "projects/:id", element: <ProjectDetail /> },
        ]
      }
    ]
  }
]);

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <AuthProvider>
      <RouterProvider router={router} />
    </AuthProvider>
  </React.StrictMode>
);


---
web\src\tiny.css

/* web/src/styles.css */
:root {
  --bg: #0f172a;         /* slate-900 */
  --card: #111827;       /* gray-900 */
  --muted: #475569;      /* slate-500 */
  --text: #e5e7eb;       /* gray-200 */
  --primary: #22d3ee;    /* cyan-400 */
  --danger: #ef4444;
  --ok: #22c55e;
  --border: #1f2937;     /* gray-800 */
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; }
body {
  margin: 0;
  background: linear-gradient(180deg, #0b1220 0%, #0f172a 100%);
  color: var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, 'Helvetica Neue', Arial;
}

.container { max-width: 1100px; margin: 24px auto; padding: 0 16px; }

.card {
  background: rgba(17,24,39,0.85);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 18px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  backdrop-filter: blur(6px);
}

h1,h2,h3 { margin: 8px 0 16px; }
h1 { font-size: 1.6rem; }
h2 { font-size: 1.3rem; color: var(--muted); }

label { display:block; font-size:.9rem; color: var(--muted); margin-bottom: 6px; }
input, select, textarea {
  width: 100%;
  background: #0b1220;
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 12px;
  outline: none;
}
input:focus, select:focus, textarea:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(34,211,238,.15);
}

.row { display: grid; gap: 12px; grid-template-columns: repeat(12,1fr); }
.col-6 { grid-column: span 6; } .col-4 { grid-column: span 4; } .col-12 { grid-column: span 12; }

.btn {
  display:inline-flex; align-items:center; gap:8px;
  padding: 10px 14px; border-radius: 12px;
  border: 1px solid var(--border);
  background: #0b1220; color: var(--text);
  cursor: pointer; text-decoration: none;
}
.btn:hover { border-color: var(--primary); }
.btn.primary { background: linear-gradient(90deg, #06b6d4, #22d3ee); color:#001018; font-weight:600; }
.btn.danger { background: #221216; border-color: #401016; color: #ffd6d6; }

.table { width: 100%; border-collapse: collapse; }
.table th, .table td { padding: 10px 12px; border-bottom: 1px solid var(--border); }
.table th { color: var(--muted); font-weight: 600; text-align: left; }
.badge { padding: 2px 8px; border-radius: 999px; border:1px solid var(--border); font-size: .8rem; }
.badge.ok { color: var(--ok); border-color: rgba(34,197,94,.5); }
.badge.warn { color: #f59e0b; border-color: rgba(245,158,11,.5); }
.badge.danger { color: var(--danger); border-color: rgba(239,68,68,.5); }


---
web\src\types.ts

export type Project = {
  id: number;
  uuid: string;
  codigo: string | null;
  nombre: string;
  estado: string;
  prioridad: number;
  avance_pct: number;
  presupuesto_monto: number;
};

export type Task = {
  id: number;
  proyecto_id: number;
  titulo: string;
  descripcion?: string | null;
  estado: "PENDIENTE" | "EN_PROGRESO" | "BLOQUEADA" | "HECHA";
  prioridad: number;
};

export type ResumenEstadoItem = {
  proyecto_id: number;
  proyecto: string;
  estado: string;
  cantidad: number;
};


---
web\src\api\auth.ts

// web/src/api/auth.ts
export type User = {
  id: number; email: string; nombre: string; apellido: string;
  roles?: { id:number; nombre:string }[];
};

const ACCESS_KEY = "access_token";
const REFRESH_KEY = "refresh_token";
const USER_KEY = "user";

export const setSession = (access: string, refresh: string, user?: User) => {
  localStorage.setItem(ACCESS_KEY, access);
  localStorage.setItem(REFRESH_KEY, refresh);
  if (user) localStorage.setItem(USER_KEY, JSON.stringify(user));
  window.dispatchEvent(new Event("storage")); // notificar a context
};

export const clearSession = () => {
  localStorage.removeItem(ACCESS_KEY);
  localStorage.removeItem(REFRESH_KEY);
  localStorage.removeItem(USER_KEY);
  window.dispatchEvent(new Event("storage"));
};

export const getAccessToken = () => localStorage.getItem(ACCESS_KEY) || "";
export const getRefreshToken = () => localStorage.getItem(REFRESH_KEY) || "";
export const getUser = (): User | null => {
  const raw = localStorage.getItem(USER_KEY);
  return raw ? JSON.parse(raw) as User : null;
};


---
web\src\api\client.ts

// web/src/api/client.ts
import { getAccessToken, getRefreshToken, setSession, clearSession } from "./auth";

const API_BASE = "http://localhost:8000";

type HttpMethod = "GET" | "POST" | "PATCH" | "DELETE";
type ReqOpts = { method?: HttpMethod; body?: any; headers?: Record<string,string> };

async function refreshAccessToken(): Promise<boolean> {
  const rt = getRefreshToken();
  if (!rt) return false;
  const res = await fetch(`${API_BASE}/api/auth/refresh`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ refresh_token: rt })
  });
  if (!res.ok) return false;
  const data = await res.json(); // { access_token, expires_in, ... }
  setSession(data.access_token, rt);
  return true;
}

export async function fetchJson<T = any>(path: string, opts: ReqOpts = {}, retry = true): Promise<T> {
  const headers: Record<string,string> = {
    "Content-Type": "application/json",
    ...(opts.headers || {})
  };
  const at = getAccessToken();
  if (at) headers.Authorization = `Bearer ${at}`;

  const res = await fetch(`${API_BASE}${path}`, {
    method: opts.method || "GET",
    headers,
    body: opts.body ? JSON.stringify(opts.body) : undefined
  });

  if (res.status === 401 && retry) {
    const ok = await refreshAccessToken();
    if (ok) return fetchJson<T>(path, opts, false);
    clearSession();
    throw new Error("Sesi√≥n expirada");
  }

  if (!res.ok) {
    const err = await res.text();
    throw new Error(err || `Error HTTP ${res.status}`);
  }
  return res.status === 204 ? (undefined as T) : await res.json();
}

export const api = {
  get: <T>(p: string) => fetchJson<T>(p),
  post: <T>(p: string, b?: any) => fetchJson<T>(p, { method: "POST", body: b }),
  patch: <T>(p: string, b?: any) => fetchJson<T>(p, { method: "PATCH", body: b }),
  del: <T>(p: string) => fetchJson<T>(p, { method: "DELETE" }),
};


---
web\src\api\projects.ts

// web/src/api/projects.ts
import { apiFetch } from "./client";

export type Project = {
  id: number;
  uuid: string;
  codigo: string | null;
  nombre: string;
  estado: string;
  prioridad: number;
  avance_pct: number;
  presupuesto_monto: number;
};

export type Task = {
  id: number;
  proyecto_id: number;
  titulo: string;
  descripcion?: string | null;
  estado: "PENDIENTE" | "EN_PROGRESO" | "BLOQUEADA" | "HECHA";
  prioridad: number;
};

export async function getProjects(): Promise<Project[]> {
  return apiFetch<Project[]>("/api/projects");
}

export async function getProjectTasks(projectId: number): Promise<Task[]> {
  return apiFetch<Task[]>(`/api/projects/${projectId}/tasks`);
}

export async function createTask(input: {
  proyecto_id: number;
  titulo: string;
  descripcion?: string;
  prioridad?: number;
}): Promise<Task> {
  return apiFetch<Task>("/api/projects/tasks", {
    method: "POST",
    body: JSON.stringify(input),
  });
}

export async function updateTask(
  taskId: number,
  patch: Partial<Pick<Task, "titulo" | "descripcion" | "prioridad" | "estado">>
): Promise<Task> {
  return apiFetch<Task>(`/api/projects/tasks/${taskId}`, {
    method: "PATCH",
    body: JSON.stringify(patch),
  });
}


---
web\src\auth\AuthContext.tsx

// web/src/auth/AuthContext.tsx
import React, { createContext, useContext, useEffect, useMemo, useState } from "react";
import { api } from "../api/client";
import { clearSession, getUser, setSession, type User } from "../api/auth";

type AuthState = { user: User | null; loading: boolean; };
type AuthCtx = AuthState & {
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
};
const Ctx = createContext<AuthCtx>({ user: null, loading: true, login: async ()=>{}, logout: ()=>{} });

export const AuthProvider: React.FC<{children: React.ReactNode}> = ({ children }) => {
  const [user, setUser] = useState<User | null>(getUser());
  const [loading, setLoading] = useState<boolean>(false);

  useEffect(() => {
    const onStorage = () => setUser(getUser());
    window.addEventListener("storage", onStorage);
    return () => window.removeEventListener("storage", onStorage);
  }, []);

  const login = async (email: string, password: string) => {
    setLoading(true);
    try {
      const data = await api.post<{access_token:string; refresh_token:string; user:User}>("/api/auth/login", { email, password });
      setSession(data.access_token, data.refresh_token, data.user);
      setUser(data.user);
    } finally {
      setLoading(false);
    }
  };

  const logout = () => {
    clearSession();
    setUser(null);
  };

  const value = useMemo(() => ({ user, loading, login, logout }), [user, loading]);
  return <Ctx.Provider value={value}>{children}</Ctx.Provider>;
};

export const useAuth = () => useContext(Ctx);


---
web\src\components\Layout.tsx

import React from "react";
import { Link, useNavigate } from "react-router-dom";
import { useAuth } from "../auth/AuthContext";

export default function Layout({ children }: { children: React.ReactNode }) {
  const { user, logout } = useAuth();
  const navigate = useNavigate();

  const onLogout = () => {
    logout();
    navigate("/login");
  };

  return (
    <div style={{ fontFamily: "system-ui, sans-serif", minHeight: "100vh", background: "#f6f7f9" }}>
      <header style={{ background: "#0f172a", color: "white", padding: "12px 16px", display: "flex", gap: 16, alignItems: "center" }}>
        <strong>ERP MVP</strong>
        <nav style={{ display: "flex", gap: 12 }}>
          <Link to="/" style={{ color: "white" }}>Inicio</Link>
          <Link to="/projects" style={{ color: "white" }}>Proyectos</Link>
        </nav>
        <div style={{ marginLeft: "auto", display: "flex", gap: 12, alignItems: "center" }}>
          {user && <span style={{ opacity: 0.8 }}>Hola, {user.nombre}</span>}
          <button onClick={onLogout} style={{ background: "transparent", border: "1px solid #94a3b8", color: "white", padding: "4px 10px", borderRadius: 6, cursor: "pointer" }}>
            Salir
          </button>
        </div>
      </header>
      <main style={{ maxWidth: 1100, margin: "20px auto", padding: "0 16px" }}>
        {children}
      </main>
    </div>
  );
}


---
web\src\components\ProtectedRoute.tsx

// web/src/routes/ProtectedRoute.tsx
import React from "react";
import { Navigate, Outlet, useLocation } from "react-router-dom";
import { useAuth } from "../auth/AuthContext";

export default function ProtectedRoute() {
  const { user, loading } = useAuth();
  const loc = useLocation();
  if (loading) return <div style={{padding:16}}>Cargando‚Ä¶</div>;
  if (!user) return <Navigate to="/login" replace state={{ from: loc }} />;
  return <Outlet />;
}


---
web\src\components\TaskRow.tsx

import { Task } from "../types";
const ESTADOS = ["PENDIENTE", "EN_PROGRESO", "BLOQUEADA", "HECHA"] as const;

export default function TaskRow({
  task,
  onChangeEstado,
}: {
  task: Task;
  onChangeEstado: (estado: Task["estado"]) => void;
}) {
  return (
    <div className="flex items-center justify-between border rounded p-2">
      <div>
        <div className="font-medium">{task.titulo}</div>
        {task.descripcion && <div className="text-sm text-gray-600">{task.descripcion}</div>}
      </div>
      <div className="flex items-center gap-2">
        <label className="text-sm text-gray-600">Estado</label>
        <select
          className="border rounded p-1"
          value={task.estado}
          onChange={(e) => onChangeEstado(e.target.value as Task["estado"])}
        >
          {ESTADOS.map(e => <option key={e} value={e}>{e}</option>)}
        </select>
      </div>
    </div>
  );
}


---
web\src\layouts\AppLayout.tsx

import React from "react";
import { Outlet } from "react-router-dom";
import Navbar from "../components/Navbar";

export default function AppLayout() {
  return (
    <div>
      <Navbar />
      <main style={{ maxWidth: 1200, margin: "0 auto", padding: 16 }}>
        <Outlet />
      </main>
    </div>
  );
}


---
web\src\layouts\SimpleLayout.tsx

import React from "react";
import { Outlet } from "react-router-dom";

export default function SimpleLayout() {
  return (
    <div style={{ maxWidth: 960, margin: "0 auto", padding: 16 }}>
      <Outlet />
    </div>
  );
}


---
web\src\lib\api.ts

// web/src/lib/api.ts
const BASE = import.meta.env.VITE_API_URL || "http://localhost:8000";

type FetchOpts = RequestInit & { json?: any };

function buildHeaders(access?: string, extra?: HeadersInit): HeadersInit {
  const base: Record<string, string> = { "Content-Type": "application/json" };
  if (access) base.Authorization = `Bearer ${access}`;
  return { ...base, ...(extra || {}) }; // <-- correcci√≥n
}

function getAuthFromStorage() {
  try {
    return JSON.parse(localStorage.getItem("auth") || "{}");
  } catch {
    return {};
  }
}

function saveAuthToStorage(auth: any) {
  localStorage.setItem("auth", JSON.stringify(auth));
}

async function refreshAccessToken(refresh_token: string) {
  const res = await fetch(`${BASE}/api/auth/refresh`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ refresh_token }),
  });
  if (!res.ok) throw new Error("Refresh inv√°lido");
  const data = await res.json();
  return data as { access_token: string; expires_in: number; token_type: string };
}

/**
 * apiFetch ‚Äî hace fetch con Bearer y, si recibe 401, intenta 1 refresh y reintenta.
 * - Guarda el nuevo access_token en localStorage.auth
 * - Si falla el refresh, limpia sesi√≥n (auth) y lanza error
 */
export async function apiFetch<T = any>(path: string, opts: FetchOpts = {}): Promise<T> {
  const auth = getAuthFromStorage();
  const access = auth?.access_token as string | undefined;
  const refresh = auth?.refresh_token as string | undefined;

  const headers = buildHeaders(access, opts.headers);
  const body = opts.json !== undefined ? JSON.stringify(opts.json) : opts.body;

  let res = await fetch(`${BASE}${path}`, { ...opts, headers, body });

  if (res.status === 401 && refresh) {
    // intentar refresh una sola vez
    try {
      const r = await refreshAccessToken(refresh);
      const updated = { ...auth, access_token: r.access_token, expires_in: r.expires_in };
      saveAuthToStorage(updated);

      const retryHeaders = buildHeaders(r.access_token, opts.headers);
      res = await fetch(`${BASE}${path}`, { ...opts, headers: retryHeaders, body });
    } catch (e) {
      localStorage.removeItem("auth");
      throw new Error("Sesi√≥n expirada. Vuelve a iniciar sesi√≥n.");
    }
  }

  if (!res.ok) {
    // intentar parsear JSON de error, si existe
    let msg = res.statusText;
    try {
      const err = await res.json();
      msg = err?.detail || JSON.stringify(err);
    } catch {}
    throw new Error(msg || "Error de solicitud");
  }

  const ct = res.headers.get("content-type") || "";
  if (ct.includes("application/json")) {
    return (await res.json()) as T;
  }
  // por si alguna llamada devuelve vac√≠o
  return undefined as T;
}


---
web\src\pages\Home.tsx

import React, { useEffect, useState } from "react";
import { useAuth } from "../auth/AuthContext";

const API = import.meta.env.VITE_API_URL ?? "http://localhost:8000";

export default function Home() {
  const { user, getAccessToken } = useAuth();
  const [health, setHealth] = useState<string>("...");
  const [err, setErr] = useState<string | null>(null);

  useEffect(() => {
    const run = async () => {
      try {
        const res = await fetch(`${API}/health`);
        if (!res.ok) throw new Error("No se pudo obtener health");
        const data = await res.json();
        setHealth(`API: ${data.status} / DB: ${data.database} / v${data.version}`);
      } catch (e: any) {
        setErr(e?.message || "Error al consultar health");
      }
    };
    void run();
  }, []);

  return (
    <div>
      <h2>‚úÖ ERP MVP UI en vivo</h2>
      <p>Si ves esto, React est√° montado y Vite sirve la app.</p>
      <p><strong>Usuario:</strong> {user?.nombre_completo}</p>
      <h3>Health de API</h3>
      {err ? <p style={{ color: "#b91c1c" }}>‚ö†Ô∏è {err}</p> : <p>{health}</p>}
      <p style={{ opacity: .7, marginTop: 24 }}>Tip: naveg√° a ‚ÄúProyectos‚Äù en el header.</p>
    </div>
  );
}


---
web\src\pages\Login.tsx

// web/src/pages/Login.tsx
import React, { useState } from "react";
import { useAuth } from "../auth/AuthContext";
import { useNavigate, useLocation } from "react-router-dom";

export default function Login() {
  const { login } = useAuth();
  const nav = useNavigate();
  const loc = useLocation() as any;
  const [email, setEmail] = useState("admin@miempresa.com");
  const [password, setPassword] = useState("admin123");
  const [error, setError] = useState<string | null>(null);
  const [busy, setBusy] = useState(false);

  const onSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setBusy(true); setError(null);
    try {
      await login(email, password);
      nav(loc?.state?.from?.pathname || "/projects", { replace: true });
    } catch (err: any) {
      setError("Credenciales inv√°lidas");
    } finally {
      setBusy(false);
    }
  };

  return (
    <div style={{maxWidth:360, margin:"64px auto", padding:24, border:"1px solid #eee", borderRadius:12}}>
      <h2 style={{marginBottom:8}}>Iniciar sesi√≥n</h2>
      <form onSubmit={onSubmit}>
        <label>Email</label>
        <input value={email} onChange={e=>setEmail(e.target.value)} type="email" required style={{width:"100%", padding:8, marginBottom:12}}/>
        <label>Password</label>
        <input value={password} onChange={e=>setPassword(e.target.value)} type="password" required style={{width:"100%", padding:8, marginBottom:12}}/>
        <button disabled={busy} style={{width:"100%", padding:10}}>{busy? "Ingresando..." : "Ingresar"}</button>
        {error && <p style={{color:"tomato"}}>{error}</p>}
      </form>
      <p style={{fontSize:12, opacity:.7, marginTop:12}}>
        Demo: admin@miempresa.com / admin123
      </p>
    </div>
  );
}


---
web\src\pages\NotFoundPage.tsx

import React from "react";

export default function NotFoundPage() {
  return (
    <div style={{ padding: 24 }}>
      <h1>404</h1>
      <p>P√°gina no encontrada.</p>
    </div>
  );
}


---
web\src\pages\ProjectDetail.tsx

// web/src/pages/ProjectDetail.tsx
import React, { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import { api } from "../api/client";

type Proyecto = { id:number; nombre:string; estado:string; codigo?:string; prioridad:number; };
type Tarea = { id:number; titulo:string; estado:string; prioridad:number; uuid:string; proyecto_id:number; };
type Member = { id:number; email:string; nombre?:string; apellido?:string; rol_en_proyecto:string; };
type SumItem = { proyecto_id:number; proyecto:string; estado:string; cantidad:number; };

const ESTADOS = ["PENDIENTE","EN_PROGRESO","BLOQUEADA","HECHA"];

export default function ProjectDetail() {
  const { id } = useParams();
  const pid = Number(id);
  const [proy, setProy] = useState<Proyecto | null>(null);
  const [tasks, setTasks] = useState<Tarea[]>([]);
  const [members, setMembers] = useState<Member[]>([]);
  const [resumen, setResumen] = useState<SumItem[]>([]);
  const [loading, setLoading] = useState(true);

  const load = async () => {
    setLoading(true);
    const [p, t, m, r] = await Promise.all([
      api.get<Proyecto>(`/api/projects/${pid}`),
      api.get<Tarea[]>(`/api/projects/${pid}/tasks`),
      api.get<Member[]>(`/api/projects/${pid}/members`).catch(()=>[]),
      api.get<SumItem[]>(`/api/projects/${pid}/report/estado`).catch(()=>[]),
    ]);
    setProy(p); setTasks(t); setMembers(m); setResumen(r);
    setLoading(false);
  };
  useEffect(()=>{ load(); }, [pid]);

  // crear tarea
  const [titulo, setTitulo] = useState("");
  const createTask = async (e: React.FormEvent) => {
    e.preventDefault();
    await api.post<Tarea>("/api/projects/tasks", { proyecto_id: pid, titulo, prioridad: 3 });
    setTitulo("");
    await load(); // ‚üµ refresca
  };

  const changeEstado = async (taskId: number, estado: string) => {
    await api.patch<Tarea>(`/api/projects/tasks/${taskId}`, { estado });
    await load(); // ‚üµ refresca despu√©s del cambio de estado
  };

  // agregar miembro por email (solo Admin en backend)
  const [email, setEmail] = useState("");
  const addMember = async (e: React.FormEvent) => {
    e.preventDefault();
    try {
      await api.post<Member>(`/api/projects/${pid}/members`, { email });
      setEmail("");
      await load();
    } catch (e:any) {
      alert("No autorizado o email inexistente");
    }
  };

  if (loading) return <div style={{padding:16}}>Cargando‚Ä¶</div>;
  if (!proy) return <div style={{padding:16}}>Proyecto no encontrado</div>;

  return (
    <div style={{maxWidth:1000, margin:"24px auto", padding:"0 16px"}}>
      <h2>Proyecto #{proy.id} ‚Äî {proy.nombre}</h2>
      <p style={{opacity:.7}}>C√≥digo: {proy.codigo || "-"} ¬∑ Estado: {proy.estado}</p>

      <div style={{display:"grid", gap:20, gridTemplateColumns:"1fr"}}>
        {/* TAREAS */}
        <section style={{border:"1px solid #eee", borderRadius:12, padding:16}}>
          <h3 style={{marginTop:0}}>Tareas</h3>
          <form onSubmit={createTask} style={{display:"flex", gap:8, marginBottom:12}}>
            <input placeholder="T√≠tulo de la tarea" value={titulo} onChange={e=>setTitulo(e.target.value)} required />
            <button type="submit">Agregar</button>
          </form>
          <table width="100%" cellPadding={8} style={{borderCollapse:"collapse"}}>
            <thead><tr style={{background:"#f7f7f7"}}><th align="left">ID</th><th align="left">T√≠tulo</th><th>Estado</th></tr></thead>
            <tbody>
              {tasks.map(t=>(
                <tr key={t.id} style={{borderTop:"1px solid #eee"}}>
                  <td>{t.id}</td>
                  <td>{t.titulo}</td>
                  <td style={{textAlign:"center"}}>
                    <select value={t.estado} onChange={(e)=>changeEstado(t.id, e.target.value)}>
                      {ESTADOS.map(s=><option key={s} value={s}>{s}</option>)}
                    </select>
                  </td>
                </tr>
              ))}
              {!tasks.length && <tr><td colSpan={3} style={{padding:12, opacity:.7}}>Sin tareas</td></tr>}
            </tbody>
          </table>
        </section>

        {/* MIEMBROS */}
        <section style={{border:"1px solid #eee", borderRadius:12, padding:16}}>
          <h3 style={{marginTop:0}}>Miembros</h3>
          <form onSubmit={addMember} style={{display:"flex", gap:8, marginBottom:12}}>
            <input type="email" placeholder="email@miempresa.com" value={email} onChange={e=>setEmail(e.target.value)} />
            <button type="submit">Agregar</button>
          </form>
          <ul style={{margin:0, paddingLeft:20}}>
            {members.map(m=>(
              <li key={m.id}>{m.email} {m.nombre ? `‚Äî ${m.nombre} ${m.apellido}` : ""} <span style={{opacity:.6}}>({m.rol_en_proyecto})</span></li>
            ))}
            {!members.length && <li style={{opacity:.7}}>Sin miembros</li>}
          </ul>
        </section>

        {/* REPORTE */}
        <section style={{border:"1px solid #eee", borderRadius:12, padding:16}}>
          <h3 style={{marginTop:0}}>Reporte por estado</h3>
          {resumen.length ? (
            <table cellPadding={8}>
              <thead><tr><th align="left">Estado</th><th>Cantidad</th></tr></thead>
              <tbody>
                {resumen.map(r=>(
                  <tr key={r.estado}><td>{r.estado}</td><td style={{textAlign:"center"}}>{r.cantidad}</td></tr>
                ))}
              </tbody>
            </table>
          ) : <p style={{opacity:.7}}>Sin datos</p>}
        </section>
      </div>
    </div>
  );
}


---
web\src\pages\Projects.tsx

// web/src/pages/Projects.tsx
import React, { useEffect, useState } from "react";
import { api } from "../api/client";
import { Link } from "react-router-dom";

type Proyecto = { id:number; codigo?:string; nombre:string; estado:string; prioridad:number; };

export default function Projects() {
  const [items, setItems] = useState<Proyecto[]>([]);
  const [loading, setLoading] = useState(true);
  const [err, setErr] = useState<string | null>(null);
  const [nombre, setNombre] = useState("");
  const [codigo, setCodigo] = useState("");

  const load = async () => {
    setLoading(true); setErr(null);
    try {
      const data = await api.get<Proyecto[]>("/api/projects");
      setItems(data);
    } catch (e:any) {
      setErr(e.message);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => { load(); }, []);

  const create = async (e: React.FormEvent) => {
    e.preventDefault();
    await api.post<Proyecto>("/api/projects", { nombre, codigo: codigo || undefined, prioridad: 3 });
    setNombre(""); setCodigo("");
    await load(); // ‚üµ refresca despu√©s de crear
  };

  return (
    <div style={{maxWidth:900, margin:"24px auto", padding:"0 16px"}}>
      <h2>Proyectos</h2>

      <form onSubmit={create} style={{display:"flex", gap:8, margin:"12px 0 20px"}}>
        <input placeholder="C√≥digo (opcional)" value={codigo} onChange={e=>setCodigo(e.target.value)} />
        <input placeholder="Nombre" value={nombre} onChange={e=>setNombre(e.target.value)} required />
        <button type="submit">Crear</button>
      </form>

      {loading && <p>Cargando‚Ä¶</p>}
      {err && <p style={{color:"tomato"}}>{err}</p>}

      {!loading && !err && (
        <table width="100%" cellPadding={8} style={{borderCollapse:"collapse"}}>
          <thead>
            <tr style={{background:"#f7f7f7"}}>
              <th align="left">ID</th><th align="left">C√≥digo</th><th align="left">Nombre</th><th>Estado</th><th></th>
            </tr>
          </thead>
          <tbody>
            {items.map(p=>(
              <tr key={p.id} style={{borderTop:"1px solid #eee"}}>
                <td>{p.id}</td>
                <td>{p.codigo || "-"}</td>
                <td>{p.nombre}</td>
                <td style={{textAlign:"center"}}>{p.estado}</td>
                <td style={{textAlign:"right"}}>
                  <Link to={`/projects/${p.id}`}>Abrir</Link>
                </td>
              </tr>
            ))}
            {!items.length && <tr><td colSpan={5} style={{padding:16, opacity:.7}}>Sin proyectos</td></tr>}
          </tbody>
        </table>
      )}
    </div>
  );
}


---
web\src\pages\Report.tsx

import React, { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import { useAuth } from "../auth/AuthContext";

type Resumen = {
  proyecto_id: number;
  proyecto: string;
  estado: string;
  cantidad: number;
};

const API = import.meta.env.VITE_API_URL ?? "http://localhost:8000";

export default function Report() {
  const { id } = useParams<{ id: string }>();
  const pid = Number(id);
  const { getAccessToken } = useAuth();
  const [items, setItems] = useState<Resumen[]>([]);
  const [err, setErr] = useState<string | null>(null);

  useEffect(() => {
    const run = async () => {
      setErr(null);
      try {
        const at = await getAccessToken();
        const res = await fetch(`${API}/api/projects/${pid}/report/estado`, {
          headers: { Authorization: `Bearer ${at}` }
        });
        if (!res.ok) throw new Error("No se pudo obtener el reporte");
        setItems(await res.json());
      } catch (e: any) {
        setErr(e?.message || "Error");
      }
    };
    void run();
  }, [pid, getAccessToken]);

  const total = items.reduce((acc, it) => acc + it.cantidad, 0);

  return (
    <div>
      <h2>Reporte por estado ¬∑ Proyecto #{pid}</h2>
      {err && <p style={{ color: "#b91c1c" }}>‚ö†Ô∏è {err}</p>}
      {!err && (
        <>
          <ul>
            {items.map(x => (
              <li key={x.estado}>{x.estado}: <strong>{x.cantidad}</strong></li>
            ))}
          </ul>
          <p><strong>Total de tareas:</strong> {total}</p>
        </>
      )}
    </div>
  );
}


---
